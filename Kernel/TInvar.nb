(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* Created By: SaveReadableNotebook *)
(* https://resources.wolframcloud.com/FunctionRepository/resources/SaveReadableNotebook *)

Notebook[
{
Cell[
CellGroupData[
{
Cell["TInvar package", "Title"],
Cell[
"Canonicalization of expressions involving the Riemann tensor",
"Subtitle"
],
Cell[
TextData[
{
StyleBox["Authors:", FontWeight -> "Bold"],
"\nKevin Kiely <kevin.kiely@ucdconnect.ie>\nBarry Wardell <barry.wardell@ucd.ie>\nAdrian Ottewill <adrian.ottewill@ucd.ie>\n",
StyleBox[
"University College Dublin, Ireland",
FontSlant -> "Italic"
],
"\n\nJos\[EAcute] M. Mart\[IAcute]n-Garc\[IAcute]a < jose@xact.es>\n",
StyleBox["Wolfram Research\n\n", FontSlant -> "Italic"],
"\[Copyright] 2023\n\nhttp://www.xact.es"
}
],
"Text"
],
Cell[
CellGroupData[
{
Cell["Begin Package", "Section"],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
"xAct`TInvar`$xTensorVersionExpected",
" ",
"=",
" ",
RowBox[
{
"{",
RowBox[
{
"\"1.2.0\"",
",",
" ",
RowBox[
{
"{",
RowBox[{"2021", ",", " ", "10", ",", " ", "17"}],
"}"
}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
"xAct`TInvar`$Version",
" ",
"=",
" ",
RowBox[
{
"{",
RowBox[
{
"\"0.1.0\"",
",",
" ",
RowBox[
{"{", RowBox[{"2023", ",", " ", "11", ",", " ", "9"}], "}"}
]
}
],
"}"
}
]
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"With",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
"xAct`TInvar`Private`TInvarSymbols",
"=",
RowBox[
{
"DeleteCases",
"[",
RowBox[
{
RowBox[
{
"Join",
"[",
RowBox[
{
RowBox[{"Names", "[", "\"xAct`TInvar`*\"", "]"}],
",",
RowBox[{"Names", "[", "\"xAct`TInvar`Private`*\"", "]"}]
}
],
"]"
}
],
",",
RowBox[
{
"\"$Version\"",
"|",
"\"xAct`TInvar`$Version\"",
"|",
"\"$TInvarVersionExpected\"",
"|",
"\"xAct`TInvar`$xTensorVersionExpected\""
}
]
}
],
"]"
}
]
}
],
"}"
}
],
",",
"\n",
"  ",
RowBox[
{
RowBox[
{
"Unprotect",
" ",
"/@",
" ",
"xAct`TInvar`Private`TInvarSymbols"
}
],
";",
"\n",
"  ",
RowBox[
{
"Clear",
" ",
"/@",
" ",
"xAct`TInvar`Private`TInvarSymbols"
}
],
";"
}
]
}
],
"\n",
"]"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
"Unevaluated",
"[",
"xAct`xCore`Private`$LastPackage",
"]"
}
],
"===",
"xAct`xCore`Private`$LastPackage"
}
],
",",
"\n",
"  ",
RowBox[
{
"xAct`xCore`Private`$LastPackage",
"=",
"\"xAct`TInvar`\""
}
]
}
],
"]"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"BeginPackage",
"[",
RowBox[
{
"\"xAct`TInvar`\"",
",",
" ",
RowBox[
{
"{",
RowBox[
{
"\"xAct`xTensor`\"",
",",
" ",
"\"xAct`xPerm`\"",
",",
" ",
"\"xAct`xCore`\""
}
],
"}"
}
]
}
],
"]"
}
]
],
"Code"
],
Cell[
TextData[
{
"Check version of ",
StyleBox["xTensor", FontSlant -> "Italic"],
". We simply compare dates:"
}
],
"Text"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"General", "::", "xTensorVersion"}],
"=",
"\"Loaded xTensor version `1` but expected version `2` at least.\""
}
],
";"
}
],
"\n",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[
{
"Not",
"@",
RowBox[
{
"OrderedQ",
"@",
RowBox[
{
"Map",
"[",
RowBox[
{
"Last",
",",
RowBox[
{
"{",
RowBox[
{"$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}
],
"}"
}
]
}
],
"]"
}
]
}
]
}
],
",",
RowBox[
{
RowBox[
{
"Message",
"[",
RowBox[
{
RowBox[{"General", "::", "xTensorVersion"}],
",",
"xAct`xTensor`$Version",
",",
"$xTensorVersionExpected"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[{"Abort", "[", "]"}]
}
]
}
],
"]"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Package xAct`TInvar`  version \"",
",",
RowBox[{"$Version", "[", RowBox[{"[", "1", "]"}], "]"}],
",",
"\", \"",
",",
RowBox[{"$Version", "[", RowBox[{"[", "2", "]"}], "]"}]
}
],
"]"
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
"Print",
"[",
"\"Copyright (C) 2023, Kevin Kiely, Barry Wardell, Adrian Ottewill and Jose M. Martin-Garcia.\"",
"]"
}
],
";"
}
]
}
],
"Code"
],
Cell[
"We specify the context xAct`TInvar` to avoid overriding the Disclaimer's of xTensor and xPerm. However we need to turn off the message General:shdw temporarily:",
"Text"
],
Cell[
BoxData[
{
RowBox[
{"Off", "[", RowBox[{"General", "::", "shdw"}], "]"}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"xAct`TInvar`Disclaimer", "[", "]"}],
":=",
RowBox[
{
"Print",
"[",
"\"These are points 11 and 12 of the General Public License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM `AS IS\264 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.\"",
"]"
}
]
}
],
"\[IndentingNewLine]",
RowBox[{"On", "[", RowBox[{"General", "::", "shdw"}], "]"}]
}
],
"Input",
InitializationCell -> True
],
Cell[
TextData[
{
"If ",
StyleBox["Invar", FontSlant -> "Italic"],
" is the last package begin read, print the GPL message:"
}
],
"Text"
],
Cell[
BoxData[
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[
{
"xAct`xCore`Private`$LastPackage",
"===",
"\"xAct`TInvar`\""
}
],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}
],
";",
"\[IndentingNewLine]",
RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
"\"These packages come with ABSOLUTELY NO WARRANTY; for details type Disclaimer[]. This is free software, and you are welcome to redistribute it under certain conditions. See the General Public License for details.\"",
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]
}
]
}
],
"]"
}
]
],
"Input",
InitializationCell -> True
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Usage messages", "Section"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"(*",
" ",
RowBox[
{
"FIXME",
":",
" ",
RowBox[
{
RowBox[
{
"make",
" ",
"this",
" ",
"public",
" ",
"as",
" ",
"a",
" ",
"hack"
}
],
" ",
"-",
" ",
RowBox[
{
"need",
" ",
"to",
" ",
"find",
" ",
"a",
" ",
"better",
" ",
"solution"
}
]
}
]
}
],
"*)"
}
],
"\n",
RowBox[{"metric", ";"}]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"$TInvarDirectory", "::", "usage"}],
"=",
"\"$TInvarDirectory is a global variable giving the directory in which the package file and the database can be found.\""
}
],
";"
}
]
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "::", "usage"}],
"=",
"\"InvarCases[s, d] returns the list of cases of order (number of metric derivatives) s and degree (number of Riemanns) d. InvarCases[s] returns the list of cases of order s. InvarCases[] returns the list of all cases handled by Invar (currently the 47 cases up to order 12 plus the algebraic case of degree 7).\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarDualCases", "::", "usage"}],
"=",
"\"InvarDualCases[s, d] returns the list of dual cases of order (number of metric derivatives) s and degree (number of Riemanns) d in dimension 4. InvarDualCases[s] returns the list of dual cases of order s. InvarDualCases[] returns the list of all dual cases handled by Invar (currently the 14 cases up to order 8 plus the algebraic case of degree 5).\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"RInv", "::", "usage"}],
"=",
"\"RInv[g][c, r] denotes the Riemann invariant of case c and index r associated to the metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualRInv", "::", "usage"}],
"=",
"\"DualRInv[g][c, r] denotes the dual Riemann invariant of case c and index r associated to the metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RPerm", "::", "usage"}],
"=",
"\"RPerm[g][{c, ed}, perm] denotes a Riemann invariant of case c with ed epsilon tensors (both associated to metric g), after reordering the indices from a canonical order using permutation perm.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"WInv", "::", "usage"}],
"=",
"\"WInv[g][c, r] denotes the Weyl invariant of case c and index r associated to the metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualWInv", "::", "usage"}],
"=",
"\"DualWInv[g][c, r] denotes the dual Weyl invariant of case c and index r associated to the metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"WPerm", "::", "usage"}],
"=",
"\"WPermRPerm[g][{Rd, ed}, perm] denotes a Weyl invariant  formed by Rd Weyl tensors and ed epsilon tensors, after reordering the indices from a canonical order using permutation perm. Contracted Weyls encode the Traceless Ricci tensor.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"RInvs", "::", "usage"}],
"=",
"\"RInvs[step, case] gives all independent Riemann invariants at the given step (1, 2, 3, 4, 5 or 6) and the given case. Using RInvs[g] instead of RInvs we get the particularization of the invariants to metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"WInvs", "::", "usage"}],
"=",
"\"WInvs[step, case] gives all independent Weyl invariants at the given step (1, 2, 3, 4, 5, 6) and the given case. Using WInvs[g] instead of WInvs we get the particularization of the invariants to metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualRInvs", "::", "usage"}],
"=",
"\"DualRInvs[step, case] gives all independent dual Riemann invariants at the given step (1, 2, 3, 4, 5 or 6) and the given case. Using DualRInvs[g] instead of RInvs we get the particularization of the dual invariants to metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualWInvs", "::", "usage"}],
"=",
"\"DualWInvs[step, case] gives all independent dual Weyl invariants at the given step (1, 2, 3, 4, 5 or 6) and the given case. Using DualWInvs[g] instead of WInvs we get the particularization of the dual invariants to metric g.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RInvRules", "::", "usage"}],
"=",
"\"RInvRules[step, case] gives the list of rules to be used to simplify Riemann non-dual invariants of the given case at the given step.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"WInvRules", "::", "usage"}],
"=",
"\"WInvRules[step, case] gives the list of rules to be used to simplify Weyl non-dual invariants of the given case at the given step.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualRInvRules", "::", "usage"}],
"=",
"\"DualRInvRules[step, case] gives the list of rules to be used to simplify Riemann dual invariants of the given case at the given step.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"DualWInvRules", "::", "usage"}],
"=",
"\"DualWInvRules[step, case] gives the list of rules to be used to simplify Weyl dual invariants of the given case at the given step.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"MaxIndex", "::", "usage"}],
"=",
"\"MaxIndex[step] gives the largest index of the non-dual invariants at the given step.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"MaxDualIndex", "::", "usage"}],
"=",
"\"MaxDualIndex[step] gives the largest index of the dual invariants at the given step.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"InvSimplify", "::", "usage"}],
"=",
"\"InvSimplify[expr, level] simplifies the invariants of the form inv[metric][case,count] in the expression expr, where inv is one of RInv, DualRInv, WInv, DualWInv. There are six possible levels of simplification: 1 means no simplification; 2 uses the cyclic identity; 3 uses the Bianchi identity; 4 commutes covariant derivatives; 5 uses dimensionally dependent (Lovelock type) identities and 6 reduces some non-dual invariants into products of dual invariants. The default level used in InvSimplify[expr] is $InvSimplifyLevel.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvToPerm", "::", "usage"}],
"=",
"\"InvToPerm[expr] converts all invariants in expr into their corresponding permutations with head RPerm or WPerm.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"PermToRiemann", "::", "usage"}],
"=",
"\"PermToRiemann[expr, cr] converts all permutations into their explicit tensor expressions. With cr=True contracted Riemann tensors are replaced by Ricci tensors. The default value used in PermToRiemann[expr] is $CurvatureRelations.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvToRiemann", "::", "usage"}],
"=",
"\"InvToRiemann[expr, cr] converts all invariants into their explicit tensor expressions. With cr=True contracted Riemann tensors are replaced by Ricci tensors. The default value used in InvToRiemann[expr] is $CurvatureRelations.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RiemannToPerm", "::", "usage"}],
"=",
"\"RiemannToPerm[expr, g] converts all Riemann scalars of metric g into their canonical permutations. If g is a list of metrics then the command is folded over the list. RiemannToPerm[expr] is automatically converted into RiemannToPerm[expr, $Metrics].\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"PermToInv", "::", "usage"}],
"=",
"\"PermToInv[expr] converts all permutations in expr into their correspondent invariants. It is assumed that the permutations have been already canonicalized.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RiemannToInv", "::", "usage"}],
"=",
"\"RiemannToInv[expr, g] converts all Riemann scalars of metric g into their invariant form. If g is a list of metrics then the command is folded over the list. RiemannToInv[expr] is automatically converted into RiemannToInv[expr, $Metrics].\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RiemannSimplify", "::", "usage"}],
"=",
"\"RiemannSimplify[expr, level, cr, g] simplifies the Riemann scalars of metric g using relations up to the given level (see usage message for InvSimplify). With cr=True contracted Riemann tensors are replaced by Ricci tensors. If g is a list of metrics then the command is folded over the list. RiemannSimplify[expr] uses the defaults $InvSimplifyLevel, $CurvatureRelations and $Metrics, respectively. See usage messages for those global variables.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"dim", "::", "usage"}],
"=",
"\"dim is a constant symbol used in the Invar rules to denote the dimension of a manifold.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"sigma", "::", "usage"}],
"=",
"\"sigma is a constant symbol used in the Invar rules to denote the sign of the determinant of a metric.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"$InvSimplifyLevel", "::", "usage"}],
"=",
"\"$InvSimplifyLevel is a global variable specifying the default level of simplification in InvSimplify. Initially it is set to 6.\""
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"$CurvatureRelations", "::", "usage"}],
"=",
"\"$CurvatureRelations is a global variable specifying the default behaviour of contracted Riemann conversion in the functions PermToRiemann, InvToRiemann and RiemannSimplify.\""
}
],
";"
}
]
}
],
"Input",
InitializationCell -> True
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Begin Private part of package", "Section"],
Cell[
BoxData[RowBox[{"Begin", "[", "\"`Private`\"", "]"}]],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Main setup", "Section"],
Cell[
CellGroupData[
{
Cell["Set options", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"ReportSetOption",
"[",
RowBox[
{
"ContractMetric",
",",
RowBox[{"AllowUpperDerivatives", "\[Rule]", "True"}]
}
],
"]"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[{RowBox[{"$InvSimplifyLevel", "=", "6"}], ";"}],
"\[IndentingNewLine]",
RowBox[
{RowBox[{"$CurvatureRelations", "=", "False"}], ";"}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"ReportSet",
"[",
RowBox[{"$PrePrint", ",", "ScreenDollarIndices"}],
"]"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"ReportSet",
"[",
RowBox[{"$CovDFormat", ",", "\"Postfix\""}],
"]"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"ReportSetOption",
"[",
RowBox[
{
"DefCovD",
",",
RowBox[{"CurvatureRelations", "\[Rule]", "False"}]
}
],
"]"
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Formatting of invariants", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"tostring", "[", "list_List", "]"}],
":=",
RowBox[
{
"StringJoin",
"[",
RowBox[{"ToString", "/@", "list"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Change",
" ",
"made",
" ",
"here",
" ",
"to",
" ",
"format",
" ",
"RInv",
" ",
"to",
" ",
"have",
" ",
"a",
" ",
"super",
" ",
"script",
" ",
"with",
" ",
"the",
" ",
"rank",
" ",
"and",
" ",
"add",
" ",
"a",
" ",
"argument",
" ",
"for",
" ",
RowBox[{"indices", ".", " ", "No"}],
" ",
"duals",
" ",
"in",
" ",
"this",
" ",
"version"
}
],
" ",
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"metric_", ",", RowBox[{"IndexList", "[", "]"}]}],
"]"
}
],
"[",
RowBox[{"case_", ",", "index_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[{"RInv", "[", "metric", "]"}],
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInv",
"[",
RowBox[{"metric_", ",", RowBox[{"IndexList", "[", "]"}]}],
"]"
}
],
"[",
RowBox[{"case_", ",", "index_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[{"DualRInv", "[", "metric", "]"}],
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"WInv",
"[",
RowBox[{"metric_", ",", RowBox[{"IndexList", "[", "]"}]}],
"]"
}
],
"[",
RowBox[{"case_", ",", "index_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[{"WInv", "[", "metric", "]"}],
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"DualWInv",
"[",
RowBox[{"metric_", ",", RowBox[{"IndexList", "[", "]"}]}],
"]"
}
],
"[",
RowBox[{"case_", ",", "index_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[{"DualWInv", "[", "metric", "]"}],
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[
{"case_List", ",", RowBox[{"index_", "?", "IntegerQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"RInv",
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInv",
"[",
RowBox[
{"case_List", ",", RowBox[{"index_", "?", "IntegerQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"DualRInv",
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"WInv",
"[",
RowBox[
{"case_List", ",", RowBox[{"index_", "?", "IntegerQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"WInv",
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualWInv",
"[",
RowBox[
{"case_List", ",", RowBox[{"index_", "?", "IntegerQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"DualRInv",
"[",
RowBox[{"0", ",", "case", ",", "index"}],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
RowBox[{"RInv", "[", RowBox[{"_", ",", "_"}], "]"}],
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"I\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
RowBox[{"WInv", "[", RowBox[{"_", ",", "_"}], "]"}],
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"W\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
RowBox[{"DualRInv", "[", RowBox[{"_", ",", "_"}], "]"}],
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"D\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
RowBox[{"DualWInv", "[", RowBox[{"_", ",", "_"}], "]"}],
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"X\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
"RInv",
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"I\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
"DualRInv",
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"D\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
"WInv",
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"W\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"Format",
"[",
RowBox[
{
"DualWInv",
"[",
RowBox[{"rank_", ",", "case_", ",", "index_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Subscript",
"[",
RowBox[
{
RowBox[
{
"Superscript",
"[",
RowBox[
{"\"X\"", ",", RowBox[{"ToString", "[", "rank", "]"}]}
],
"]"
}
],
",",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
RowBox[{"tostring", "[", "case", "]"}],
",",
"\",\"",
" ",
",",
" ",
RowBox[{"ToString", "[", "index", "]"}]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Reading Invar files as rules", "Subsection"],
Cell[
BoxData[RowBox[{RowBox[{"$ReadWeyl", "=", "False"}], ";"}]],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"$TInvarDirectory",
"=",
RowBox[
{
"ParentDirectory",
"[",
RowBox[{"DirectoryName", "[", "$InputFileName", "]"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{RowBox[{"$DataBaseDir", "=", "\"Riemann/\""}], ";"}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Need",
" ",
"to",
" ",
"add",
" ",
"the",
" ",
"backwards",
" ",
"compatibility",
" ",
"notation"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"From",
" ",
"Riemann",
" ",
"to",
" ",
RowBox[{"Weyl", ".", " ", "No"}],
" ",
"Dimension",
" ",
"added"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"WInvs",
"[",
RowBox[{"step_Integer", ",", "rank_", ",", "deg_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"step", ",", "rank", ",", "deg"}],
"]"
}
],
"/.",
RowBox[{"RInv", "\[Rule]", "WInv"}]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[{"No", " ", "change", " ", "from", " ", "Invar"}],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
"SetAttributes",
"[",
RowBox[{"ProtSet", ",", "HoldFirst"}],
"]"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"ProtSet",
"[",
RowBox[
{RowBox[{"head_", "[", "args___", "]"}], ",", "value_"}
],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{"prot", "=", RowBox[{"Unprotect", "[", "head", "]"}]}
],
"}"
}
],
",",
RowBox[
{
RowBox[
{
"Set",
"[",
RowBox[{RowBox[{"head", "[", "args", "]"}], ",", "value"}],
"]"
}
],
";",
RowBox[
{
"Protect",
"[",
RowBox[{"Evaluate", "[", "prot", "]"}],
"]"
}
],
";",
"value"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["File Names", "Subsection"],
Cell[
BoxData[
RowBox[
{"(*", RowBox[{"Same", " ", "as", " ", "Invar"}], "*)"}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"intercase", "[", "case_List", "]"}],
":=",
RowBox[
{
"StringJoin",
"@",
RowBox[
{
"Insert",
"[",
RowBox[
{
RowBox[{"ToString", "/@", "case"}],
",",
"\"_\"",
",",
RowBox[
{
"List",
"/@",
RowBox[
{
"Range",
"[",
RowBox[{"2", ",", RowBox[{"Length", "[", "case", "]"}]}],
"]"
}
]
}
]
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
"No",
" ",
"Dim",
" ",
"also",
" ",
"modified",
" ",
"for",
" ",
"rank"
}
],
"-",
"case",
"-",
"step"
}
],
" ",
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"filename",
"[",
RowBox[{"step_", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
"\"RInv-\"",
",",
RowBox[{"ToString", "[", "rank", "]"}],
",",
"\"-\"",
",",
RowBox[{"intercase", "[", "case", "]"}],
",",
"\"-\"",
",",
RowBox[{"ToString", "[", "step", "]"}]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"filename",
"[",
RowBox[
{
RowBox[
{"step", ":", RowBox[{"(", RowBox[{"5", "|", "6"}], ")"}]}
],
",",
"rank_",
",",
"case_",
",",
"dim_"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"filename",
"[",
RowBox[
{
RowBox[{"ToString", "[", "step", "]"}],
",",
"rank",
",",
"case"
}
],
"]"
}
],
"<>",
"\"_\"",
"<>",
RowBox[{"ToString", "[", "dim", "]"}]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"dualfilename",
"[",
RowBox[{"5", ",", "rank_", ",", "case_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"dualfilename",
"[",
RowBox[{"\"5\"", ",", "rank", ",", "case"}],
"]"
}
],
"<>",
"\"_\"",
"<>",
RowBox[{"ToString", "[", "dim", "]"}]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"dualfilename",
"[",
RowBox[{"step_", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"StringJoin",
"[",
RowBox[
{
"\"DInv-\"",
",",
RowBox[{"ToString", "[", "rank", "]"}],
",",
"\"-\"",
",",
RowBox[{"intercase", "[", "case", "]"}],
",",
"\"-\"",
",",
RowBox[{"ToString", "[", "step", "]"}]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Check the import of the files", "Subsection"],
Cell[
BoxData[
RowBox[{"(*", RowBox[{"No", " ", "changes"}], "*)"}]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"RInv", "::", "nodatabase"}],
"=",
"\"Can't find the Invar database. You can download it from http://www.xact.es/Invar/.\""
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[{"CheckImport", "[", "args__", "]"}],
":=",
RowBox[
{
"Quiet",
"[",
RowBox[
{
RowBox[
{
"Check",
"[",
RowBox[
{
RowBox[{"Import", "[", "args", "]"}],
",",
RowBox[
{
RowBox[
{"Message", "[", RowBox[{"RInv", "::", "nodatabase"}], "]"}
],
";",
RowBox[{"Abort", "[", "]"}]
}
]
}
],
"]"
}
],
",",
RowBox[{"Import", "::", "nffil"}]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"All",
" ",
"permutations",
" ",
"are",
" ",
"in",
" ",
"Mathematica",
" ",
"notation"
}
],
"*)"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell[
TextData[
{
"Reading functions. ",
StyleBox["Mathematica", FontSlant -> "Italic"],
" notation"
}
],
"Subsection"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"firstof", "[", RowBox[{"{", "}"}], "]"}],
":=",
"0"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"firstof",
"[",
RowBox[
{"{", RowBox[{"{", RowBox[{"a_", ",", "b_"}], "}"}], "}"}
],
"]"
}
],
":=",
"a"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"firstof",
"[",
RowBox[
{
"{",
RowBox[
{RowBox[{"{", RowBox[{"a_", ",", "b_"}], "}"}], ",", "__"}
],
"}"
}
],
"]"
}
],
":=",
"a"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"positionof",
"[",
RowBox[{"string_String", ",", "substring_String"}],
"]"
}
],
":=",
RowBox[
{
"firstof",
"@",
RowBox[
{
"StringPosition",
"[",
RowBox[{"string", ",", "substring"}],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[{RowBox[{"movetofirst", "[", "0", "]"}], ":=", "1"}],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"movetofirst", "[", "x_", "]"}],
":=",
RowBox[{"x", "+", "4"}]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[{"replacebrackets", "[", "string_String", "]"}],
":=",
RowBox[
{
"StringReplace",
"[",
RowBox[
{
"string",
",",
RowBox[
{
"{",
RowBox[
{
RowBox[{"\"[\"", "\[Rule]", "\"{\""}],
",",
RowBox[{"\"]\"", "\[Rule]", "\"}\""}]
}
],
"}"
}
]
}
],
"]"
}
]
}
],
"\n",
RowBox[
{
RowBox[{"replaceequal", "[", "string_String", "]"}],
":=",
RowBox[
{
"StringReplace",
"[",
RowBox[
{
"string",
",",
RowBox[{"{", RowBox[{"\"=\"", "\[Rule]", "\"->\""}], "}"}]
}
],
"]"
}
]
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[{"readline", "[", "string_", "]"}],
":=",
RowBox[
{
"StringTake",
"[",
RowBox[
{
"string",
",",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"movetofirst",
"@",
RowBox[
{
"positionof",
"[",
RowBox[{"string", ",", "\" := \""}],
"]"
}
]
}
],
",",
RowBox[
{RowBox[{"StringLength", "[", "string", "]"}], "-", "1"}
]
}
],
"}"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Need",
" ",
"to",
" ",
"check",
" ",
"this",
" ",
"works",
" ",
"for",
" ",
"TInvar"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"ReadInvarPerms",
"[",
RowBox[{"filename_", ",", "\"Maple\""}],
"]"
}
],
":=",
RowBox[
{
"ToExpression",
"/@",
RowBox[
{
"replacebrackets",
"/@",
RowBox[
{
"readline",
"/@",
RowBox[
{
"CheckImport",
"[",
RowBox[
{
RowBox[
{
"StringJoin",
"[",
RowBox[{"$TInvarDirectory", ",", "\"/\"", ",", "filename"}],
"]"
}
],
",",
"\"Lines\""
}
],
"]"
}
]
}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"ReadInvarRules",
"[",
RowBox[{"filename_", ",", "\"Mathematica\""}],
"]"
}
],
":=",
RowBox[
{
"ToExpression",
"/@",
RowBox[
{
"CheckImport",
"[",
RowBox[
{
RowBox[
{
"FileNameJoin",
"[",
RowBox[
{"{", RowBox[{"$TInvarDirectory", ",", "filename"}], "}"}
],
"]"
}
],
",",
"\"Lines\""
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Removing rules", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Come",
" ",
"back",
" ",
"to",
" ",
"this",
" ",
"when",
" ",
"I",
" ",
"have",
" ",
"all",
" ",
"the",
" ",
"steps"
}
],
"*)"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Metric argument", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Need",
" ",
"to",
" ",
"test",
" ",
RowBox[{"this", ".", " ", "No"}],
" ",
"changes",
" ",
"made"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"addRdep",
"[",
RowBox[
{
"Rule",
"[",
RowBox[
{
RowBox[
{"inv_", "[", RowBox[{"case_", ",", "count_"}], "]"}
],
",",
"rhs_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Rule",
"[",
RowBox[
{
RowBox[
{
RowBox[
{"inv", "[", RowBox[{"metric_", ",", "indexlist_"}], "]"}
],
"[",
RowBox[{"case", ",", "count"}],
"]"
}
],
",",
RowBox[
{
"rhs",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"RInv", "\[Rule]", RowBox[{"RInv", "[", "metric", "]"}]}
],
",",
RowBox[
{
"DualRInv",
"\[Rule]",
RowBox[{"DualRInv", "[", "metric", "]"}]
}
],
",",
RowBox[
{"WInv", "\[Rule]", RowBox[{"WInv", "[", "metric", "]"}]}
],
",",
RowBox[
{
"DualWInv",
"\[Rule]",
RowBox[{"DualWInv", "[", "metric", "]"}]
}
]
}
],
"}"
}
]
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"metric_", ",", "indexlist_IndexList"}],
"]"
}
],
"[",
"args__",
"]"
}
],
":=",
RowBox[
{
RowBox[{"RInvs", "[", "args", "]"}],
"/.",
RowBox[
{"RInv", "\[Rule]", RowBox[{"RInv", "[", "metric", "]"}]}
]
}
]
}
],
";",
RowBox[
{
RowBox[
{
RowBox[
{
"WInvs",
"[",
RowBox[{"metric_", ",", "indexlist_IndexList"}],
"]"
}
],
"[",
"args__",
"]"
}
],
":=",
RowBox[
{
RowBox[{"WInvs", "[", "args", "]"}],
"/.",
RowBox[
{"WInv", "\[Rule]", RowBox[{"WInv", "[", "metric", "]"}]}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"DualRInvs", "[", "metric_", "]"}],
"[",
"args__",
"]"
}
],
":=",
RowBox[
{
RowBox[{"DualRInvs", "[", "args", "]"}],
"/.",
RowBox[
{
"DualRInv",
"\[Rule]",
RowBox[{"DualRInv", "[", "metric", "]"}]
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"DualWInvs", "[", "metric_", "]"}],
"[",
"args__",
"]"
}
],
":=",
RowBox[
{
RowBox[{"DualWInvs", "[", "args", "]"}],
"/.",
RowBox[
{
"DualWInv",
"\[Rule]",
RowBox[{"DualWInv", "[", "metric", "]"}]
}
]
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"$DefaultDim",
":=",
RowBox[
{
"DimOfVBundle",
"@",
RowBox[
{
"VBundleOfMetric",
"@",
RowBox[{"First", "@", "$Metrics"}]
}
]
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Cases", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"With",
" ",
"the",
" ",
"way",
" ",
"this",
" ",
"is",
" ",
"currently",
" ",
"implimented",
" ",
"it",
" ",
"is",
" ",
"not",
" ",
"very",
" ",
"clear",
" ",
"as",
" ",
"the",
" ",
"cases",
" ",
"will",
" ",
"depend",
" ",
"on",
" ",
"the",
" ",
RowBox[{"rank", ".", " ", "Should"}],
" ",
"I",
" ",
"impliment",
" ",
"a",
" ",
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"rank_", ",", " ", "order_", ",", "deg_"}],
"]"
}
],
"?"
}
]
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "0", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "order"}], "]"}
],
",",
RowBox[
{
"{",
RowBox[{"order", ",", "2", ",", "14", ",", "2"}],
"}"
}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "1", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"1", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "3", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "2", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "2", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "3", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"3", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "3", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "4", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "2", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "5", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"5", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "3", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "6", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "4", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "7", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"7", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "5", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "8", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"8", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "4", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "9", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"9", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "5", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "10", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"10", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "6", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", "12", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"12", ",", "order"}], "]"}
],
",",
RowBox[
{"{", RowBox[{"order", ",", "6", ",", "6", ",", "2"}], "}"}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[
{"rank_", ",", RowBox[{"order_Integer", "?", "EvenQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"InvarCases",
"[",
RowBox[
{
"rank",
",",
"order",
",",
RowBox[
{
"Reverse",
"@",
RowBox[{"Range", "[", RowBox[{"order", "/", "2"}], "]"}]
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[
{
"rank_",
",",
RowBox[{"order_Integer", "?", "EvenQ"}],
",",
"list_List"
}
],
"]"
}
],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"rank", ",", "order", ",", "#"}],
"]"
}
],
"&"
}
],
"/@",
"list"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[
{"rank_", ",", RowBox[{"order_Integer", "?", "OddQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"InvarCases",
"[",
RowBox[
{
"rank",
",",
"order",
",",
RowBox[
{
"Reverse",
"@",
RowBox[
{
"Range",
"[",
RowBox[
{
"Round",
"[",
RowBox[
{RowBox[{"(", RowBox[{"order", "-", "1"}], ")"}], "/", "2"}
],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[
{
"rank_",
",",
RowBox[{"order_Integer", "?", "OddQ"}],
",",
"list_List"
}
],
"]"
}
],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"rank", ",", "order", ",", "#"}],
"]"
}
],
"&"
}
],
"/@",
"list"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "2", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "0", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "4", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "6", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "4"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}
],
"}"
}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "8", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"3", ",", "3"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "4"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "5"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}],
"}"
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "10", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "8"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "7"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"3", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"4", ",", "4"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "3", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "2", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "2", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "4"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "5"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}],
"}"
}
],
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}],
"}"
}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "6"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[
{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}
],
"}"
}
],
"}"
}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "14", ",", "7"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
],
"}"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "2", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "0", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "2", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "0", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"1", ",", "3", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "1", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"3", ",", "3", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "1", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"5", ",", "3", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "1", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "4", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "4", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "4", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"8", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"7", ",", "5", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "3", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"5", ",", "5", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "3", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"3", ",", "5", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "3", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"1", ",", "5", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "3", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"9", ",", "5", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"7", ",", "5", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"5", ",", "5", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"3", ",", "5", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"1", ",", "5", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"8", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"10", ",", "6", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"8", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"12", ",", "6", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"10", ",", "6", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"8", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"6", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"4", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"2", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"InvarCases", "[", RowBox[{"0", ",", "14"}], "]"}],
":=",
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "14", ",", "7"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "2", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "0", "}"}], "}"}]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "4", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "4", ",", "2"}], "]"}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "6", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "1"}], "]"}
],
"=",
RowBox[{"{", RowBox[{"{", "6", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "2"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "3"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarCases", "[", RowBox[{"0", ",", "8", ",", "4"}], "]"}
],
"=",
RowBox[
{
"{",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "8", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"3", ",", "3"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "4"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "10", ",", "5"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}],
"}"
}
],
"}"
}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "10", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "8"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "7"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"3", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"4", ",", "4"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "6"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "5"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "3", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "2", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "2", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "4"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}
],
",",
RowBox[
{"{", RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "5"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}],
"}"
}
],
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}],
"}"
}
]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "12", ",", "6"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[
{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}
],
"}"
}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarCases",
"[",
RowBox[{"0", ",", "14", ",", "7"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
],
"}"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"InvarDualCases", "[", "0", "]"}],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{"InvarDualCases", "[", RowBox[{"0", ",", "order"}], "]"}
],
",",
RowBox[
{
"{",
RowBox[{"order", ",", "2", ",", "10", ",", "2"}],
"}"
}
]
}
],
"]"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", RowBox[{"order_Integer", "?", "EvenQ"}]}],
"]"
}
],
":=",
RowBox[
{
"InvarDualCases",
"[",
RowBox[
{
"0",
",",
"order",
",",
RowBox[
{
"Reverse",
"@",
RowBox[{"Range", "[", RowBox[{"order", "/", "2"}], "]"}]
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[
{
"0",
",",
RowBox[{"order_Integer", "?", "EvenQ"}],
",",
"list_List"
}
],
"]"
}
],
":=",
RowBox[
{
"Flatten",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "order", ",", "#"}],
"]"
}
],
"&"
}
],
"/@",
"list"
}
],
",",
"1"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvarDualCases", "[", RowBox[{"0", ",", "10"}], "]"}
],
":=",
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "10", ",", "5"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "2", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "0", "}"}], "}"}]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "4", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "2", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "4", ",", "2"}],
"]"
}
],
"=",
RowBox[
{"{", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], "}"}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "6", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "4", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "6", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "6", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "8", ",", "1"}],
"]"
}
],
"=",
RowBox[{"{", RowBox[{"{", "6", "}"}], "}"}]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "8", ",", "2"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "4"}], "}"}],
",",
RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}],
",",
RowBox[{"{", RowBox[{"2", ",", "2"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "8", ",", "3"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
RowBox[{"{", RowBox[{"0", ",", "0", ",", "2"}], "}"}],
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "1"}], "}"}]
}
],
"}"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "8", ",", "4"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}
],
"}"
}
]
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvarDualCases",
"[",
RowBox[{"0", ",", "10", ",", "5"}],
"]"
}
],
"=",
RowBox[
{
"{",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}],
"}"
}
],
"}"
}
]
}
],
";"
}
],
"\n"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"InvarDualCases", "[", "x_", "]"}],
":=",
RowBox[
{
"Throw",
"[",
RowBox[
{
"Print",
"[",
RowBox[{"\"Invalid order \"", ",", "x"}],
"]"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[{"InvarDualCases", "[", "args__", "]"}],
":=",
RowBox[
{
"Throw",
"[",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Invar cannot work with the dual cases \"",
",",
RowBox[{"{", "args", "}"}]
}
],
"]"
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell[
"Maximum degree and index for a given rank",
"Subsection"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "}"}]}],
"]"
}
],
":=",
"0"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "0", "}"}]}],
"]"
}
],
":=",
"1"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
":=",
"3"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "2", "}"}]}],
"]"
}
],
":=",
"2"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
":=",
"9"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
":=",
"12"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
":=",
"12"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
":=",
"12"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}
]
}
],
"]"
}
],
":=",
"38"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "2"}], "}"}]
}
],
"]"
}
],
":=",
"99"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "1"}], "}"}]
}
],
"]"
}
],
":=",
"125"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "4"}], "}"}]}
],
"]"
}
],
":=",
"126"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}]}
],
"]"
}
],
":=",
"138"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"2", ",", "2"}], "}"}]}
],
"]"
}
],
":=",
"86"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "6", "}"}]}],
"]"
}
],
":=",
"105"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}],
"}"
}
]
}
],
"]"
}
],
":=",
"204"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}
]
}
],
"]"
}
],
":=",
"1020"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}
]
}
],
"]"
}
],
":=",
"1749"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "4"}], "}"}]
}
],
"]"
}
],
":=",
"1473"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "3"}], "}"}]
}
],
"]"
}
],
":=",
"3099"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "2"}], "}"}]
}
],
"]"
}
],
":=",
"1622"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "2"}], "}"}]
}
],
"]"
}
],
":=",
"1617"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "6"}], "}"}]}
],
"]"
}
],
":=",
"1665"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "5"}], "}"}]}
],
"]"
}
],
":=",
"1770"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"2", ",", "4"}], "}"}]}
],
"]"
}
],
":=",
"1746"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"3", ",", "3"}], "}"}]}
],
"]"
}
],
":=",
"962"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "8", "}"}]}],
"]"
}
],
":=",
"1155"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}
],
"}"
}
]
}
],
"]"
}
],
":=",
"1613"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "2"}],
"}"
}
]
}
],
"]"
}
],
":=",
"12722"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "1"}],
"}"
}
]
}
],
"]"
}
],
":=",
"27022"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "4"}], "}"}
]
}
],
"]"
}
],
":=",
"19617"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "1", ",", "3"}], "}"}
]
}
],
"]"
}
],
":=",
"60984"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "2", ",", "2"}], "}"}
]
}
],
"]"
}
],
":=",
"30974"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}
]
}
],
"]"
}
],
":=",
"62465"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}
]
}
],
"]"
}
],
":=",
"5606"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "6"}], "}"}]
}
],
"]"
}
],
":=",
"25590"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "5"}], "}"}]
}
],
"]"
}
],
":=",
"53160"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "2", ",", "4"}], "}"}]
}
],
"]"
}
],
":=",
"52764"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"1", ",", "1", ",", "4"}], "}"}]
}
],
"]"
}
],
":=",
"27396"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "3", ",", "3"}], "}"}]
}
],
"]"
}
],
":=",
"27024"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"1", ",", "2", ",", "3"}], "}"}]
}
],
"]"
}
],
":=",
"54654"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"2", ",", "2", ",", "2"}], "}"}]
}
],
"]"
}
],
":=",
"9104"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "8"}], "}"}]}
],
"]"
}
],
":=",
"25515"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "7"}], "}"}]}
],
"]"
}
],
":=",
"26670"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"2", ",", "6"}], "}"}]}
],
"]"
}
],
":=",
"26460"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"3", ",", "5"}], "}"}]}
],
"]"
}
],
":=",
"26670"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"4", ",", "4"}], "}"}]}
],
"]"
}
],
":=",
"13607"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "10", "}"}]}],
"]"
}
],
":=",
"15120"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
]
}
],
"]"
}
],
":=",
"16532"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
]
}
],
"]"
}
],
":=",
"217395"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
]
}
],
"]"
}
],
":=",
"3406747"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"2", ",", RowBox[{"{", "0", "}"}]}],
"]"
}
],
"=",
"1"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"4", ",", RowBox[{"{", "0", "}"}]}],
"]"
}
],
"=",
"3"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"5", ",", RowBox[{"{", "1", "}"}]}],
"]"
}
],
"=",
"15"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"3", ",", RowBox[{"{", "1", "}"}]}],
"]"
}
],
"=",
"6"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"1", ",", RowBox[{"{", "1", "}"}]}],
"]"
}
],
"=",
"2"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"6", ",", RowBox[{"{", "2", "}"}]}],
"]"
}
],
"=",
"90"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"4", ",", RowBox[{"{", "2", "}"}]}],
"]"
}
],
"=",
"39"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"2", ",", RowBox[{"{", "2", "}"}]}],
"]"
}
],
"=",
"9"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"8", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
"=",
"315"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"6", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
"=",
"135"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"4", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
"=",
"33"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"2", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
"=",
"5"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"7", ",", RowBox[{"{", "3", "}"}]}],
"]"
}
],
"=",
"630"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"5", ",", RowBox[{"{", "3", "}"}]}],
"]"
}
],
"=",
"285"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"3", ",", RowBox[{"{", "3", "}"}]}],
"]"
}
],
"=",
"66"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"1", ",", RowBox[{"{", "3", "}"}]}],
"]"
}
],
"=",
"11"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"9", ",", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"5670"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"7", ",", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"2520"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"5", ",", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"600"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"3", ",", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"96"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"1", ",", RowBox[{"{", RowBox[{"0", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"14"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"8", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
"=",
"5040"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"6", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
"=",
"2340"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"4", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
"=",
"549"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[{"2", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
"=",
"86"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"10", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"28350"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"8", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"12915"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"6", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"3060"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"4", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"492"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"2", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"62"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"10", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"56700"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"8", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"25830"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"6", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"6075"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"4", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"966"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{"2", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"119"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"12",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"155925"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"10",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"70875"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"8",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"16695"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"6",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"2670"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"4",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"336"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxIndex",
"[",
RowBox[
{
"2",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"33"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "}"}]}],
"]"
}
],
"=",
"0"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "0", "}"}]}],
"]"
}
],
"=",
"1"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}]}
],
"]"
}
],
"=",
"4"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "2", "}"}]}],
"]"
}
],
"=",
"3"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "0"}], "}"}]
}
],
"]"
}
],
"=",
"27"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"58"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "1"}], "}"}]}
],
"]"
}
],
"=",
"36"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "4", "}"}]}],
"]"
}
],
"=",
"32"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{"{", RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}
]
}
],
"]"
}
],
"=",
"232"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "0", ",", "2"}], "}"}]
}
],
"]"
}
],
"=",
"967"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[{"{", RowBox[{"0", ",", "1", ",", "1"}], "}"}]
}
],
"]"
}
],
"=",
"1047"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"0", ",", "4"}], "}"}]}
],
"]"
}
],
"=",
"876"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}]}
],
"]"
}
],
"=",
"920"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{"0", ",", RowBox[{"{", RowBox[{"2", ",", "2"}], "}"}]}
],
"]"
}
],
"=",
"478"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[{"0", ",", RowBox[{"{", "6", "}"}]}],
"]"
}
],
"=",
"435"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}],
"}"
}
]
}
],
"]"
}
],
"=",
"2582"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}
],
"}"
}
]
}
],
"]"
}
],
"=",
"35090"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"MaxDualIndex",
"[",
RowBox[
{
"0",
",",
RowBox[
{
"{",
RowBox[
{
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0",
",",
"0"
}
],
"}"
}
]
}
],
"]"
}
],
"=",
"558323"
}
],
";"
}
],
"\[IndentingNewLine]"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank_", ",", "case_"}], "]"}
],
":=",
RowBox[
{
"Throw",
"[",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Dual case\"",
",",
" ",
"case",
",",
"\" and rank\"",
",",
"rank",
",",
"\" not included.\""
}
],
"]"
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["More on RInvs", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
" ",
RowBox[{"Added", " ", "rank", " ", "argument"}],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Map",
"[",
RowBox[
{
RowBox[
{
RowBox[
{"RInv", "[", RowBox[{"rank", ",", "case", ",", "#"}], "]"}
],
"&"
}
],
",",
RowBox[
{
"Range",
"[",
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Map",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInv",
"[",
RowBox[{"rank", ",", "case", ",", "#"}],
"]"
}
],
"&"
}
],
",",
RowBox[
{
"Range",
"[",
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"WInvs",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"WInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Map",
"[",
RowBox[
{
RowBox[
{
RowBox[
{"WInv", "[", RowBox[{"rank", ",", "case", ",", "#"}], "]"}
],
"&"
}
],
",",
RowBox[
{
"Range",
"[",
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DualWInvs",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"WInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Map",
"[",
RowBox[
{
RowBox[
{
RowBox[
{"WInv", "[", RowBox[{"rank", ",", "case", ",", "#"}], "]"}
],
"&"
}
],
",",
RowBox[
{
"Range",
"[",
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Dispatch Rules", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[{"No", " ", "dim", " ", "added", " ", "free"}],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"RInv",
",",
"step_",
",",
"rank_",
",",
"case_",
",",
"dim___"
}
],
"]"
}
],
":=",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[{"{", "sigma", "}"}],
",",
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{"RInv", ",", "step", ",", "rank", ",", "case", ",", "dim"}
],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"RInvRules",
"[",
RowBox[{"step", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"DualRInv",
",",
"step_",
",",
"rank_",
",",
"case_",
",",
"dim___"
}
],
"]"
}
],
":=",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[{"{", "sigma", "}"}],
",",
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"DualRInv",
",",
"step",
",",
"rank",
",",
"case",
",",
"dim"
}
],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"step", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"WInv",
",",
"step_",
",",
"rank_",
",",
"case_",
",",
"dim___"
}
],
"]"
}
],
":=",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[{"{", "sigma", "}"}],
",",
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{"WInv", ",", "step", ",", "rank", ",", "case", ",", "dim"}
],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"WInvRules",
"[",
RowBox[{"step", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"DualWInv",
",",
"step_",
",",
"rank_",
",",
"case_",
",",
"dim___"
}
],
"]"
}
],
":=",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[{"{", "sigma", "}"}],
",",
RowBox[
{
RowBox[
{
"DispatchRules",
"[",
RowBox[
{
"DualWInv",
",",
"step",
",",
"rank",
",",
"case",
",",
"dim"
}
],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"DualWInvRules",
"[",
RowBox[{"step", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell[
"Reading permutations for the invariants: step 1",
"Subsection"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"MaxIndex", "[", "case", "]"}],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 1, rank \"",
",",
"rank",
" ",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
RowBox[
{
"result",
"=",
RowBox[
{
"Inner",
"[",
RowBox[
{
"Rule",
",",
RowBox[
{
"tmphead",
"@@",
RowBox[
{
"RInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
RowBox[
{
"tmphead",
"@@",
RowBox[
{
"ReadInvarPerms",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"1/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Maple\""
}
],
"]"
}
]
}
],
",",
"List"
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"1", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"MaxIndex", "[", "case", "]"}],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading DualInvRules for step 1, rank \"",
",",
"rank",
" ",
",",
"\" and case  \"",
",",
"case"
}
],
"]"
}
],
";",
RowBox[
{
"result",
"=",
RowBox[
{
"Inner",
"[",
RowBox[
{
"Rule",
",",
RowBox[
{
"tmphead",
"@@",
RowBox[
{
"DualRInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
RowBox[
{
"tmphead",
"@@",
RowBox[
{
"ReadInvarPerms",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"1/\"",
"<>",
RowBox[
{
"dualfilename",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Maple\""
}
],
"]"
}
]
}
],
",",
"List"
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"reversecycles",
"[",
RowBox[{"inv_", "\[Rule]", RowBox[{"{", "cycles__", "}"}]}],
"]"
}
],
":=",
RowBox[
{RowBox[{"Cycles", "[", "cycles", "]"}], "\[Rule]", "inv"}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"reversecycles",
"[",
RowBox[{"inv_", "->", RowBox[{"{", "}"}]}],
"]"
}
],
":=",
RowBox[
{
RowBox[{"Cycles", "[", RowBox[{"{", "}"}], "]"}],
"->",
"inv"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"RInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchPermToRInvRules",
"[",
RowBox[{"rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"DispatchPermToRInvRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"reversecycles",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchDualRInvToPermRules",
"[",
RowBox[{"rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"DispatchDualRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DispatchPermToDualRInvRules",
"[",
RowBox[{"rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"DispatchPermToDualRInvRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
],
"=",
RowBox[
{
"Dispatch",
"[",
RowBox[
{
"reversecycles",
"/@",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"WInvRules",
"[",
RowBox[{"1", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
"/.",
RowBox[{"RInv", "\[Rule]", "WInv"}]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualWInvRules",
"[",
RowBox[{"1", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
"/.",
RowBox[{"DualRInv", "\[Rule]", "DualWInv"}]
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[{"Examples", " ", "with", " ", "invariants"}]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Add",
" ",
"in",
" ",
"the",
" ",
"rest",
" ",
"of",
" ",
"the",
" ",
"rules",
" ",
"later"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"2", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"2", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"1", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"2", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 2, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"2/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"2", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading DualInvRules for step 2, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"2/\"",
"<>",
RowBox[
{
"dualfilename",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"3", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"3", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"2", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"3", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 3, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"3/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"3", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 3, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"3/\"",
"<>",
RowBox[
{
"dualfilename",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"4", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"4", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"3", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"4", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"MaxIndex", "[", "case", "]"}],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 4, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"4/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"4", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 4, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"4/\"",
"<>",
RowBox[
{
"dualfilename",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["Step 5 dim dep rules", "Subsection"],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank_", ",", "case_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"5", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"DualRInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"5", ",", "rank_", ",", "case_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"5", ",", "rank", ",", " ", "case", ",", "dim"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"4", ",", "rank", ",", "case"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank_", ",", "case_List", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"rank", ">", "0"}],
",",
RowBox[{RowBox[{"result", "=", RowBox[{"{", "}"}]}], ";"}],
" ",
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 5, rank \"",
",",
"rank",
",",
"\", case \"",
"  ",
",",
"case",
",",
"  ",
"\" and dimension \"",
",",
"dim"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"5_\"",
"<>",
RowBox[{"ToString", "[", "dim", "]"}],
"<>",
"\"/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
]
}
]
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"5", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"5", ",", "rank_", ",", "case_List", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxDualIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"rank", ">", "0"}],
",",
RowBox[{RowBox[{"result", "=", RowBox[{"{", "}"}]}], ";"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 5, rank \"",
",",
"rank",
",",
"\" and case \"",
",",
"case"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"5_\"",
"<>",
RowBox[{"ToString", "[", "dim", "]"}],
"<>",
"\"/\"",
"<>",
RowBox[
{
"dualfilename",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
]
}
]
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvRules",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"6", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"RInvs",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"6", ",", "rank_", ",", "case_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
RowBox[
{
"Complement",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
RowBox[
{
"First",
"/@",
RowBox[
{
"RInvRules",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"6", ",", "rank_", ",", "case_"}],
"]"
}
],
":=",
RowBox[
{
"DualRInvs",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"6", ",", "rank_", ",", "case_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"DualRInvs",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
RowBox[
{
"DualRInvs",
"[",
RowBox[{"5", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"6", ",", "rank_", ",", "case_List"}],
"]"
}
],
":=",
RowBox[
{
"RInvRules",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "$DefaultDim"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"6", ",", "rank_", ",", "case_List", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[{"{", "sigma", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "result", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"MaxIndex", "[", RowBox[{"rank", ",", "case"}], "]"}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"rank", ">", "0"}],
",",
RowBox[{RowBox[{"result", "=", RowBox[{"{", "}"}]}], ";"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"Print",
"[",
RowBox[
{
"\"Reading InvRules for step 6, rank \"",
",",
"rank",
",",
"\", case \"",
",",
"case",
",",
"\" and dimension \"",
",",
"dim"
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"result",
"=",
RowBox[
{
"ReadInvarRules",
"[",
RowBox[
{
RowBox[
{
"$DataBaseDir",
"<>",
"\"6_\"",
"<>",
RowBox[{"ToString", "[", "dim", "]"}],
"<>",
"\"/\"",
"<>",
RowBox[
{
"filename",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
]
}
],
",",
"\"Mathematica\""
}
],
"]"
}
]
}
]
}
]
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"ProtSet",
"[",
RowBox[
{
RowBox[
{
"RInvRules",
"[",
RowBox[{"6", ",", "rank", ",", "case", ",", "dim"}],
"]"
}
],
",",
"result"
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["The ten main functions", "Section"],
Cell[
CellGroupData[
{
Cell["InvSimplify", "Subsection"],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"InvSimplify", "[", "expr_", "]"}],
":=",
RowBox[
{
"InvSimplify",
"[",
RowBox[{"expr", ",", "$InvSimplifyLevel"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"InvSimplify", "[", RowBox[{"expr_", ",", "1"}], "]"}
],
":=",
"expr"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvSimplify", "[", RowBox[{"expr_", ",", "step_"}], "]"}
],
":=",
RowBox[
{
"Expand",
"[",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{
RowBox[{"(", RowBox[{"RInv", "|", "WInv"}], ")"}],
"[",
RowBox[{"metric_", ",", "Inds_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "_", ",", "_"}],
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[
{
"Block",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"dim",
"=",
RowBox[
{
"DimOfVBundle",
"@",
RowBox[{"VBundleOfMetric", "@", "metric"}]
}
]
}
],
",",
RowBox[
{
"sigma",
"=",
RowBox[{"SignDetOfMetric", "[", "metric", "]"}]
}
],
",",
RowBox[{"inds", "=", "Inds"}]
}
],
"}"
}
],
",",
RowBox[
{
"InvSimplify1",
"[",
RowBox[{"inv", ",", "step", ",", "dim"}],
"]"
}
]
}
],
"]"
}
]
}
],
" ",
"}"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[
{
"InvSimplify",
",",
RowBox[{"{", RowBox[{"1", ",", "2"}], "}"}]
}
],
"]"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify1",
"[",
RowBox[{"inv_", ",", "1", ",", "_"}],
"]"
}
],
":=",
"inv"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify1",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"(", RowBox[{"DualRInv", "|", "DualWInv"}], ")"}],
"[",
RowBox[{"_", ",", "_"}],
"]"
}
],
"[",
RowBox[{"_", ",", "_", ",", "_"}],
"]"
}
],
",",
"_",
",",
"dim_Integer"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"Print",
"[",
"\"Duals are only handled in dimension 4.\"",
"]"
}
],
"/;",
RowBox[{"dim", "=!=", "4"}]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify1",
"[",
RowBox[
{"_", ",", RowBox[{"5", "|", "6"}], ",", "dim_Integer"}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"Print",
"[",
"\"Levels 5 and 6 of simplication are only possible in dimension 4.\"",
"]"
}
],
"/;",
RowBox[{"dim", "=!=", "4"}]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify1",
"[",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{"_", "[", RowBox[{"_", ",", "inds_IndexList"}], "]"}
],
"[",
RowBox[{"_", ",", "_", ",", "_"}],
"]"
}
]
}
],
",",
RowBox[
{
"step",
":",
RowBox[
{
"(",
RowBox[{"2", "|", "3", "|", "4", "|", "5", "|", "6"}],
")"
}
]
}
],
",",
"_"
}
],
"]"
}
],
":=",
RowBox[
{
"Expand",
"[",
RowBox[
{
RowBox[
{
"InvSimplify56",
"[",
RowBox[
{
RowBox[
{"InvSimplify234", "[", RowBox[{"inv", ",", "step"}], "]"}
],
",",
"step"
}
],
"]"
}
],
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"RInv",
"\[Rule]",
RowBox[{"RInv", "[", RowBox[{"metric", ",", "inds"}], "]"}]
}
],
",",
RowBox[
{
"DualRInv",
"\[Rule]",
RowBox[
{"DualRInv", "[", RowBox[{"metric", ",", "inds"}], "]"}
]
}
],
",",
RowBox[
{
"WInv",
"\[Rule]",
RowBox[{"WInv", "[", RowBox[{"metric", ",", "inds"}], "]"}]
}
],
",",
RowBox[
{
"DualWInv",
"\[Rule]",
RowBox[
{"DualWInv", "[", RowBox[{"metric", ",", "inds"}], "]"}
]
}
]
}
],
"}"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify1",
"[",
RowBox[{"inv_", ",", "step_", ",", "dim_"}],
"]"
}
],
":=",
RowBox[
{
"Print",
"[",
RowBox[
{"\"Invalid level of simplification: \"", ",", "step"}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify234",
"[",
RowBox[
{
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"metric_", ",", "indexlist_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
",",
"step_"
}
],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
RowBox[{"inds", "=", "indexlist"}],
",",
RowBox[
{
"newexpr",
"=",
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
]
}
]
}
],
"}"
}
],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[
{
"FreeQ",
"[",
RowBox[
{
RowBox[
{
"RInvs",
"[",
" ",
RowBox[{"step", ",", "rank", ",", "case"}],
"]"
}
],
",",
"newexpr"
}
],
"]"
}
],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"newexpr",
"=",
RowBox[
{
"newexpr",
"/.",
RowBox[
{
"DispatchRules",
"[",
RowBox[{"RInv", ",", "2", ",", "rank", ",", "case"}],
"]"
}
]
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"newexpr",
"=",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"step", "\[GreaterEqual]", "3"}],
",",
RowBox[
{
"newexpr",
"/.",
RowBox[
{
"DispatchRules",
"[",
RowBox[{"RInv", ",", "3", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"newexpr"
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"newexpr",
"=",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"step", "\[GreaterEqual]", "4"}],
",",
RowBox[
{
"newexpr",
"/.",
RowBox[
{
"DispatchRules",
"[",
RowBox[{"RInv", ",", "4", ",", "rank", ",", "case"}],
"]"
}
]
}
],
",",
"newexpr"
}
],
"]"
}
]
}
]
}
]
}
],
"]"
}
],
";",
"\[IndentingNewLine]",
"newexpr"
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"RulesFor",
"[",
RowBox[
{
RowBox[
{"inv_", "[", RowBox[{"0", ",", "case_", ",", "_"}], "]"}
],
",",
"step_"
}
],
"]"
}
],
":=",
RowBox[
{
"DispatchRules",
"[",
RowBox[
{"inv", ",", "step", ",", "0", ",", "case", ",", "dim"}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify56",
"[",
RowBox[
{
"expr_",
",",
RowBox[{"step_", "/;", RowBox[{"step", "<", "5"}]}]
}
],
"]"
}
],
":=",
"expr"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Have",
" ",
"not",
" ",
"implimented",
" ",
"dimension",
" ",
"dependent",
" ",
"rules",
" ",
"for",
" ",
"Tensors"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{"InvSimplify56", "[", RowBox[{"expr_", ",", "5"}], "]"}
],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{
"(",
RowBox[
{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}
],
")"
}
],
"[",
RowBox[{"0", ",", "case_", ",", "_"}],
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[
{
"(",
RowBox[
{
"inv",
"/.",
RowBox[{"RulesFor", "[", RowBox[{"inv", ",", "5"}], "]"}]
}
],
")"
}
]
}
],
"}"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{"InvSimplify56", "[", RowBox[{"expr_", ",", "6"}], "]"}
],
":=",
RowBox[
{
RowBox[
{"InvSimplify56", "[", RowBox[{"expr", ",", "5"}], "]"}
],
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[{"(", RowBox[{"RInv", "|", "WInv"}], ")"}],
"[",
RowBox[{"0", ",", "case_", ",", "_"}],
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[
{
"(",
RowBox[
{
"inv",
"/.",
RowBox[{"RulesFor", "[", RowBox[{"inv", ",", "6"}], "]"}]
}
],
")"
}
]
}
],
"}"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvSimplify56",
"[",
RowBox[{"expr_", ",", "step_"}],
"]"
}
],
":=",
"expr"
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["InvToPerm", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"toCycles",
"[",
RowBox[{"cycles", ":", RowBox[{"{", "___List", "}"}]}],
"]"
}
],
":=",
RowBox[
{"Apply", "[", RowBox[{"Cycles", ",", "cycles"}], "]"}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"InvToPerm", "[", "expr_", "]"}],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{
RowBox[{"(", RowBox[{"RInv", "|", "WInv"}], ")"}],
"[",
RowBox[{"_", ",", "_"}],
"]"
}
],
"[",
RowBox[{"_", ",", "_", ",", "_"}],
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[{"InvToPerm", "[", "inv", "]"}]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[{"InvToPerm", "[", RowBox[{"-", "info___"}], "]"}],
":=",
RowBox[{"-", RowBox[{"InvToPerm", "[", "info", "]"}]}]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Commuting",
" ",
"derivatives",
" ",
"can",
" ",
"introduce",
" ",
"new",
" ",
"contractions",
" ",
"in",
" ",
"the",
" ",
"Riemann",
" ",
RowBox[{"terms", ".", " ", "Need"}],
" ",
"to",
" ",
"add",
" ",
"dummy",
" ",
"indices",
" ",
"when",
" ",
"this",
" ",
"happens"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvToPerm",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"metric_", ",", "inds_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "0"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
"inds",
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"InvToPerm",
"[",
RowBox[
{
RowBox[
{
"WInv",
"[",
RowBox[{"metric_", ",", "inds_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"WPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "0"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
"inds",
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvToPerm",
"[",
RowBox[
{
RowBox[
{
"DualRInv",
"[",
RowBox[{"metric_", ",", "inds_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "1"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
"inds",
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchDualRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"InvToPerm",
"[",
RowBox[
{
RowBox[
{
"DualWInv",
"[",
RowBox[{"metric_", ",", "inds_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"WPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "1"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
"inds",
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchDualRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[{"InvToPerm", ",", "1"}],
"]"
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
"InvToPerm",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"metric_", ",", "indexlist_IndexList"}],
"]"
}
],
"[",
RowBox[{"rank_", ",", "case_", ",", "count_"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
"dummyInds",
",",
"upperInds",
" ",
",",
"lowerInds",
",",
"newcontracted"
}
],
"}"
}
],
",",
RowBox[
{
RowBox[
{
"dummyinds",
"=",
RowBox[
{
RowBox[{"4", RowBox[{"Length", "[", "case", "]"}]}],
"+",
RowBox[{"Total", "[", "case", "]"}],
"-",
RowBox[{"Length", "[", "indexlist", "]"}]
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"upperInds",
"=",
RowBox[
{
"IndexList",
"@@",
RowBox[
{
"Table",
"[",
RowBox[
{
RowBox[
{
"DummyIn",
"[",
RowBox[{"VBundleOfMetric", "[", "metric", "]"}],
"]"
}
],
",",
RowBox[
{
"{",
RowBox[
{"i", ",", "1", ",", RowBox[{"dummyinds", "/", "2"}]}
],
"}"
}
]
}
],
"]"
}
]
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
"newcontracted",
"=",
RowBox[
{
"Join",
"[",
RowBox[
{"upperInds", ",", RowBox[{"Minus", "/@", "upperInds"}]}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[
{
RowBox[{"Length", "[", "indexlist", "]"}],
"==",
RowBox[
{
RowBox[{"4", RowBox[{"Length", "[", "case", "]"}]}],
"+",
RowBox[{"Total", "[", "case", "]"}]
}
]
}
],
",",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "0"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
"indexlist",
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
],
",",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "0"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
RowBox[
{
"Join",
"[",
RowBox[{"indexlist", ",", "newcontracted"}],
"]"
}
],
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
RowBox[
{
"(*",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case", ",", "0"}], "}"}],
",",
RowBox[{"{", "rank", "}"}],
",",
RowBox[{"Join", "[", "indexlist", "]"}],
",",
RowBox[
{
"toCycles",
"[",
RowBox[
{
RowBox[
{
"RInv",
"[",
RowBox[{"rank", ",", "case", ",", "count"}],
"]"
}
],
"/.",
RowBox[
{
"DispatchRInvToPermRules",
"[",
RowBox[{"rank", ",", "case"}],
"]"
}
]
}
],
"]"
}
]
}
],
"]"
}
],
"*)"
}
],
"*)"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["PermToRiemann", "Subsection"],
Cell[
BoxData[
{
RowBox[
{
RowBox[{"canon", "[", "metric_", "]"}],
":=",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "upinds", "}"}],
",",
RowBox[
{
RowBox[
{
"upinds",
"=",
RowBox[
{
"DummyIn",
"/@",
RowBox[
{
"ConstantArray",
"[",
RowBox[
{
RowBox[{"VBundleOfMetric", "[", "metric", "]"}],
",",
"18"
}
],
"]"
}
]
}
]
}
],
";",
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"IndexList",
"@@",
RowBox[
{
"Flatten",
"@",
RowBox[
{
"Transpose",
"[",
RowBox[
{
"{",
RowBox[{"upinds", ",", RowBox[{"Minus", "/@", "upinds"}]}],
"}"
}
],
"]"
}
]
}
]
}
]
}
]
}
],
"]"
}
]
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
RowBox[{"upindices", "[", "metric_", "]"}],
":=",
RowBox[
{
RowBox[{"upindices", "[", "metric", "]"}],
"=",
RowBox[
{
"DummyIn",
"/@",
RowBox[
{
"ConstantArray",
"[",
RowBox[
{
RowBox[{"VBundleOfMetric", "[", "metric", "]"}],
",",
"18"
}
],
"]"
}
]
}
]
}
]
}
],
";",
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"canon", "[", "metric_", "]"}],
":=",
RowBox[
{
"IndexList",
"@@",
RowBox[
{
"Flatten",
"@",
RowBox[
{
"Transpose",
"[",
RowBox[
{
"{",
RowBox[
{
RowBox[
{"a", "=", RowBox[{"upindices", "[", "metric", "]"}]}
],
",",
RowBox[{"Minus", "/@", "a"}]
}
],
"}"
}
],
"]"
}
]
}
]
}
]
}
],
";"
}
],
"*)"
}
]
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"translate",
"[",
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_", ",", "dege_"}], "}"}],
",",
RowBox[{"{", "frees_", "}"}],
",",
"index_IndexList",
",",
"perm_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"First",
"@",
RowBox[
{
"TranslatePerm",
"[",
RowBox[
{
"perm",
",",
RowBox[
{
"{",
RowBox[
{
"Images",
",",
RowBox[
{
RowBox[{"4", RowBox[{"Length", "[", "case", "]"}]}],
"+",
RowBox[{"Plus", "@@", "case"}],
"+",
RowBox[{"4", "dege"}]
}
]
}
],
"}"
}
]
}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
"info_",
",",
"frees_",
",",
"indexlist_",
",",
RowBox[{"-", "perm_"}]
}
],
"]"
}
],
":=",
RowBox[
{
"-",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{"info", ",", "frees", ",", "indexlist", ",", "perm"}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"WPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
"info_",
",",
"frees_",
",",
"indexlist_",
",",
RowBox[{"-", "perm_"}]
}
],
"]"
}
],
":=",
RowBox[
{
"-",
RowBox[
{
RowBox[{"WPerm", "[", "metric", "]"}],
"[",
RowBox[
{"info", ",", "frees", ",", "indexlist", ",", "perm"}
],
"]"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"riemannof",
"[",
RowBox[
{
"metric_",
",",
"0",
",",
"indices_",
",",
RowBox[{"{", RowBox[{"other___", ",", "n_"}], "}"}]
}
],
"]"
}
],
":=",
RowBox[
{
"With",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{"CD", "=", RowBox[{"CovDOfMetric", "[", "metric", "]"}]}
],
"}"
}
],
",",
RowBox[
{
RowBox[
{
RowBox[
{
"Apply",
"[",
RowBox[
{
"Composition",
",",
RowBox[
{
"CD",
"/@",
RowBox[
{
"indices",
"[",
RowBox[
{
"[",
RowBox[
{
"Range",
"[",
RowBox[
{
RowBox[{"4", "+", "n"}],
",",
"5",
",",
RowBox[{"-", "1"}]
}
],
"]"
}
],
"]"
}
],
"]"
}
]
}
]
}
],
"]"
}
],
"[",
RowBox[
{
"Apply",
"[",
RowBox[
{
RowBox[{"Riemann", "[", "CD", "]"}],
",",
RowBox[{"Take", "[", RowBox[{"indices", ",", "4"}], "]"}]
}
],
"]"
}
],
"]"
}
],
RowBox[
{
"riemannof",
"[",
RowBox[
{
"metric",
",",
"0",
",",
RowBox[
{
"Drop",
"[",
RowBox[{"indices", ",", RowBox[{"4", "+", "n"}]}],
"]"
}
],
",",
RowBox[{"{", "other", "}"}]
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"riemannof",
"[",
RowBox[
{"metric_", ",", "1", ",", "indices_", ",", "case_"}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"riemannof",
"[",
RowBox[
{
"metric",
",",
"0",
",",
RowBox[
{
"Drop",
"[",
RowBox[{"indices", ",", RowBox[{"-", "4"}]}],
"]"
}
],
",",
"case"
}
],
"]"
}
],
RowBox[
{
"Apply",
"[",
RowBox[
{
RowBox[{"epsilon", "[", "metric", "]"}],
",",
RowBox[
{
"Take",
"[",
RowBox[{"indices", ",", RowBox[{"-", "4"}]}],
"]"
}
]
}
],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"riemannof",
"[",
RowBox[
{
"_",
",",
"_",
",",
RowBox[{"{", "}"}],
",",
RowBox[{"{", "}"}]
}
],
"]"
}
],
":=",
"1"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"PermToRiemann", "[", "rperm_", "]"}],
":=",
RowBox[
{
"PermToRiemann",
"[",
RowBox[{"rperm", ",", "$CurvatureRelations"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToRiemann",
"[",
RowBox[
{
RowBox[
{
"rperm",
":",
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_", ",", "dege_"}], "}"}],
",",
RowBox[{"{", "0", "}"}],
",",
"free_IndexList",
",",
"_"
}
],
"]"
}
]
}
],
",",
"cr_"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric", ",", "cr", ",", "False"}],
"]"
}
],
"[",
RowBox[
{
"riemannof",
"[",
RowBox[
{
"metric",
",",
"dege",
",",
RowBox[
{
"List",
"@@",
RowBox[
{
RowBox[
{
"IndexSort",
"[",
RowBox[
{
"Join",
"[",
RowBox[
{"free", ",", RowBox[{"canon", "[", "metric", "]"}]}
],
"]"
}
],
"]"
}
],
"[",
RowBox[
{"[", RowBox[{"translate", "[", "rperm", "]"}], "]"}
],
"]"
}
]
}
],
",",
RowBox[{"Reverse", "[", "case", "]"}]
}
],
"]"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToRiemann",
"[",
RowBox[
{
RowBox[
{
"rperm",
":",
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_", ",", "dege_"}], "}"}],
",",
RowBox[{"{", "rank_", "}"}],
",",
"free_IndexList",
",",
"_"
}
],
"]"
}
]
}
],
",",
"cr_"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric", ",", "cr", ",", "True"}],
"]"
}
],
"[",
RowBox[
{
"riemannof",
"[",
RowBox[
{
"metric",
",",
"dege",
",",
RowBox[
{
"List",
"@@",
RowBox[
{
RowBox[
{
"IndexSort",
"[",
RowBox[
{
"Join",
"[",
RowBox[
{"free", ",", RowBox[{"canon", "[", "metric", "]"}]}
],
"]"
}
],
"]"
}
],
"[",
RowBox[
{"[", RowBox[{"translate", "[", "rperm", "]"}], "]"}
],
"]"
}
]
}
],
",",
RowBox[{"Reverse", "[", "case", "]"}]
}
],
"]"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"To",
" ",
"Ricci",
" ",
"function",
" ",
"needs",
" ",
"to",
" ",
"be",
" ",
"written",
" ",
"for",
" ",
"free",
" ",
"indices",
" ",
"Here",
" ",
"the",
" ",
"thrid",
" ",
"agrument",
" ",
"is",
" ",
"True",
" ",
"if",
" ",
"the",
" ",
"expression",
" ",
"is",
" ",
"a",
" ",
"tensor",
" ",
"and",
" ",
"False",
" ",
"if",
" ",
"it",
" ",
"is",
" ",
"a",
" ",
"scalar"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric_", ",", "False", ",", "False"}],
"]"
}
],
"[",
"expr_",
"]"
}
],
":=",
RowBox[{"Scalar", "[", "expr", "]"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric_", ",", "False", ",", "True"}],
"]"
}
],
"[",
"expr_",
"]"
}
],
":=",
"expr"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric_", ",", "True", ",", "False"}],
"]"
}
],
"[",
"expr_",
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"Scalar",
"@",
RowBox[
{
"ContractMetric",
"[",
RowBox[
{
RowBox[
{
"expr",
"/.",
RowBox[
{
"CurvatureRelations",
"[",
RowBox[
{
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"Riemann"
}
],
"]"
}
]
}
],
",",
"metric"
}
],
"]"
}
]
}
],
"/.",
RowBox[
{
"CurvatureRelations",
"[",
RowBox[
{
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"Ricci"
}
],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"ToWeyl", "[", RowBox[{"expr_", ",", "cd_"}], "]"}],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
RowBox[{"Riemann", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"Weyl", "[", "cd", "]"}]
}
],
",",
RowBox[
{
RowBox[{"Ricci", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"TFRicci", "[", "cd", "]"}]
}
]
}
],
"}"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"ToRicci",
"[",
RowBox[{"metric_", ",", "True", ",", "True"}],
"]"
}
],
"[",
"expr_",
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"ContractMetric",
"[",
RowBox[
{
RowBox[
{
"expr",
"/.",
RowBox[
{
"CurvatureRelations",
"[",
RowBox[
{
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"Riemann"
}
],
"]"
}
]
}
],
",",
"metric"
}
],
"]"
}
],
"/.",
RowBox[
{
"CurvatureRelations",
"[",
RowBox[
{
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"Ricci"
}
],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"ToWeyl", "[", RowBox[{"expr_", ",", "cd_"}], "]"}],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
RowBox[{"Riemann", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"Weyl", "[", "cd", "]"}]
}
],
",",
RowBox[
{
RowBox[{"Ricci", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"TFRicci", "[", "cd", "]"}]
}
]
}
],
"}"
}
]
}
]
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["InvToRiemann", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[{"InvToRiemann1", "[", "cr_", "]"}],
"[",
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{
RowBox[
{
"(",
RowBox[
{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}
],
")"
}
],
"[",
RowBox[{"_", ",", "_"}],
"]"
}
],
"[",
RowBox[{"_", ",", "_", ",", "_"}],
"]"
}
]
}
],
"]"
}
],
":=",
RowBox[
{
"PermToRiemann",
"[",
RowBox[{RowBox[{"InvToPerm", "[", "inv", "]"}], ",", "cr"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"InvToRiemann", "[", "expr_", "]"}],
":=",
RowBox[
{
"InvToRiemann",
"[",
RowBox[{"expr", ",", "$CurvatureRelations"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{"InvToRiemann", "[", RowBox[{"expr_", ",", "cr_"}], "]"}
],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
RowBox[
{
"inv",
":",
RowBox[
{
RowBox[
{
RowBox[
{
"(",
RowBox[
{"RInv", "|", "DualRInv", "|", "WInv", "|", "DualWInv"}
],
")"
}
],
"[",
RowBox[{"_", ",", "_"}],
"]"
}
],
"[",
RowBox[{"_", ",", "_", ",", "_"}],
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[
{
RowBox[{"InvToRiemann1", "[", "cr", "]"}],
"[",
"inv",
"]"
}
]
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[
{
"InvToRiemann",
",",
RowBox[{"{", RowBox[{"1", ",", "2"}], "}"}]
}
],
"]"
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["RiemannToPerm", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"No",
" ",
"change",
" ",
"for",
" ",
"first",
" ",
"three"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"addone",
"[",
RowBox[{"head_", "[", "n_Integer", "]"}],
"]"
}
],
":=",
RowBox[{"head", "[", RowBox[{"n", "+", "1"}], "]"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"addone",
"[",
RowBox[
{
"casePlus",
"[",
RowBox[{"{", RowBox[{"head_", ",", "n_Integer"}], "}"}],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{"{", RowBox[{"head", ",", RowBox[{"n", "+", "1"}]}], "}"}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
"SetAttributes",
"[",
RowBox[
{
"casePlus",
",",
RowBox[{"{", RowBox[{"Flat", ",", "Orderless"}], "}"}]
}
],
"]"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"head_", ",", "n__"}], "}"}],
",",
"c___",
",",
RowBox[{"{", RowBox[{"head_", ",", "m__"}], "}"}]
}
],
"]"
}
],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"head", ",", "m", ",", "n"}], "}"}],
",",
"c"
}
],
"]"
}
]
}
],
";"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[{"casePlus", "[", RowBox[{"0", ",", "c___"}], "]"}],
":=",
RowBox[{"casePlus", "[", "c", "]"}]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{RowBox[{"casePlus", "[", "ERROR", "]"}], ":=", "ERROR"}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{"casePlus", "[", RowBox[{"ERROR", ",", "__"}], "]"}
],
":=",
"ERROR"
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"degrees",
"[",
RowBox[{"expr_", ",", "cd_", ",", "metric_"}],
"]"
}
],
":=",
RowBox[
{
"With",
"[",
RowBox[
{
RowBox[
{
"{",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"riemann", "=", RowBox[{"Riemann", "[", "cd", "]"}]}
],
",",
"\[IndentingNewLine]",
RowBox[{"ricci", "=", RowBox[{"Ricci", "[", "cd", "]"}]}],
",",
"\[IndentingNewLine]",
RowBox[
{
"ricciscalar",
"=",
RowBox[{"RicciScalar", "[", "cd", "]"}]
}
],
",",
"\[IndentingNewLine]",
RowBox[{"weyl", "=", RowBox[{"Weyl", "[", "cd", "]"}]}],
",",
"\[IndentingNewLine]",
RowBox[
{"tfricci", "=", RowBox[{"TFRicci", "[", "cd", "]"}]}
],
",",
"\[IndentingNewLine]",
RowBox[
{"eps", "=", RowBox[{"epsilon", "[", "metric", "]"}]}
]
}
],
"}"
}
],
",",
"\[IndentingNewLine]",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[{"{", "deg", "}"}],
",",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"deg",
"[",
RowBox[
{
RowBox[{RowBox[{"cd", "[", "_", "]"}], "[", "expr1_", "]"}],
"x_."
}
],
"]"
}
],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[
{"addone", "[", RowBox[{"deg", "[", "expr1", "]"}], "]"}
],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"deg", "[", RowBox[{"_riemann", " ", "x_."}], "]"}],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"Riemann", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"deg", "[", RowBox[{"_ricci", " ", "x_."}], "]"}],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"Ricci", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"deg", "[", RowBox[{"_ricciscalar", " ", "x_."}], "]"}
],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"RicciScalar", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"deg", "[", RowBox[{"_weyl", " ", "x_."}], "]"}],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"Weyl", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"deg", "[", RowBox[{"_tfricci", " ", "x_."}], "]"}],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"TFRicci", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[{"deg", "[", RowBox[{"_eps", " ", "x_."}], "]"}],
":=",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"epsilon", ",", "0"}], "}"}],
",",
RowBox[{"deg", "[", "x", "]"}]
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{"deg", "[", RowBox[{"1", "|", RowBox[{"-", "1"}]}], "]"}
],
":=",
"0"
}
],
";",
"\[IndentingNewLine]",
RowBox[{RowBox[{"deg", "[", "x_", "]"}], ":=", "Infinity"}],
";",
"\[IndentingNewLine]",
RowBox[{"deg", "[", "expr", "]"}]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Added",
" ",
"a",
" ",
"metric",
" ",
"times",
" ",
"so",
" ",
"that",
" ",
"expression",
" ",
"with",
" ",
SuperscriptBox["g", "ab"],
" ",
"can",
" ",
"be",
" ",
"passed",
" ",
"through"
}
],
" ",
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm",
"[",
RowBox[{"expr_", ",", "args___"}],
"]"
}
],
":=",
RowBox[
{
"RiemannToPerm0",
"[",
RowBox[
{
RowBox[
{
"ContractMetric",
"@",
RowBox[{"Expand", "[", "expr", "]"}]
}
],
",",
"args"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[
{
"RiemannToPerm",
",",
RowBox[{"{", RowBox[{"1", ",", "2"}], "}"}]
}
],
"]"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
"(*",
" ",
RowBox[{"Thread", " ", "over", " ", "sums"}],
" ",
"*)"
}
]
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm0",
"[",
RowBox[{"expr_Plus", ",", "args___"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
RowBox[
{"RiemannToPerm0", "[", RowBox[{"#", ",", "args"}], "]"}
],
"&"
}
],
"/@",
"expr"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm0",
"[",
RowBox[{"expr_", ",", "args___"}],
"]"
}
],
":=",
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[
{
"BreakInMonomials",
"[",
RowBox[
{
"BreakScalars",
"@",
RowBox[{"PutScalar", "[", "expr", "]"}]
}
],
"]"
}
],
",",
"args"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"(*",
" ",
RowBox[
{
"Deal",
" ",
"with",
" ",
"the",
" ",
"second",
" ",
"argument"
}
],
" ",
"*)"
}
]
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"RiemannToPerm1", "[", "expr_", "]"}],
":=",
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr", ",", "$Metrics"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr_", ",", "metrics_List"}],
"]"
}
],
":=",
RowBox[
{
"Fold",
"[",
RowBox[{"RiemannToPerm1", ",", "expr", ",", "metrics"}],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[{RowBox[{"a_", "?", "NumberQ"}], " ", "expr_"}],
",",
"metric_"
}
],
"]"
}
],
":=",
RowBox[
{
"a",
" ",
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
"(*",
RowBox[{"Look", " ", "for", " ", "scalars"}],
" ",
"*)"
}
]
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[{"Monomial", "[", "expr_", "]"}],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
"\[IndentingNewLine]",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[
{
"expr",
",",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"metric"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr_Times", ",", "metric_"}],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
RowBox[
{"RiemannToPerm1", "[", RowBox[{"#", ",", "metric"}], "]"}
],
"&"
}
],
"/@",
"expr"
}
]
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[{"Scalar", "[", "expr_", "]"}],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[
{
"expr",
",",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"metric"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr_Times", ",", "metric_Symbol"}],
"]"
}
],
":=",
RowBox[
{
"RiemannToPerm2",
"[",
RowBox[
{
RowBox[
{
RowBox[
{"ScalarTest", "[", RowBox[{"#", ",", "metric"}], "]"}
],
"&"
}
],
"/@",
"expr"
}
],
"]"
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"ScalarTest",
"[",
RowBox[{"expr_", ",", "metric_Symbol"}],
"]"
}
],
":=",
RowBox[
{
"If",
"[",
RowBox[
{
RowBox[{"ScalarQ", "[", "expr", "]"}],
",",
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
],
",",
"expr"
}
],
"]"
}
]
}
]
}
],
"*)"
}
]
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[{"Scalar", "[", "expr_", "]"}],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[
{
"expr",
",",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"metric"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[{"Monomial", "[", "expr_", "]"}],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[
{
"expr",
",",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"metric"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[
{"Power", "[", RowBox[{"expr_", ",", "n_Integer"}], "]"}
],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
"Power",
"[",
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
],
",",
"n"
}
],
"]"
}
]
}
],
";"
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{RowBox[{"tensor_Symbol", "[", "]"}], ",", "metric_Symbol"}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
RowBox[
{"{", RowBox[{RowBox[{"{", "0", "}"}], ",", "0"}], "}"}
],
",",
RowBox[{"{", "0", "}"}],
",",
RowBox[{"IndexList", "[", "]"}],
",",
RowBox[
{
"xAct`xPerm`Cycles",
"[",
RowBox[{"{", RowBox[{"2", ",", "3"}], "}"}],
"]"
}
]
}
],
"]"
}
],
"/;",
RowBox[
{
"tensor",
"===",
RowBox[
{
"RicciScalar",
"[",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
"]"
}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"(*",
" ",
RowBox[
{
"Possibilities",
" ",
"for",
" ",
"the",
" ",
"first",
" ",
"argument"
}
],
" ",
"*)"
}
],
"\n",
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm2",
"[",
RowBox[
{
RowBox[{RowBox[{"a_", "?", "NumberQ"}], " ", "expr_"}],
",",
"metric_"
}
],
"]"
}
],
":=",
RowBox[
{
"a",
" ",
RowBox[
{
"RiemannToPerm2",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
]
}
]
}
],
";",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"RiemannToPerm2",
"[",
RowBox[{"expr_", ",", "metric_Symbol"}],
"]"
}
],
":=",
RowBox[
{
"HoldForm",
"[",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[
{
"expr",
",",
RowBox[{"CovDOfMetric", "[", "metric", "]"}],
",",
"metric"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
],
"]"
}
]
}
],
";"
}
],
"*)"
}
],
"\[IndentingNewLine]",
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[
{
RowBox[
{
RowBox[{"metric", "[", RowBox[{"a_", ",", "b_"}], "]"}],
"expr_"
}
],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"metric", "[", RowBox[{"a", ",", "b"}], "]"}],
RowBox[
{
"RiemannToPerm1",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
]
}
]
}
],
";"
}
],
"*)"
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"(*",
" ",
RowBox[{"0.", " ", "Trivial", " ", "cases"}],
" ",
"*)"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
RowBox[
{"arrange", "[", RowBox[{"0", ",", "_", ",", "_"}], "]"}
],
":=",
"0"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"arrange",
"[",
RowBox[{"expr_", ",", "Infinity", ",", "_"}],
"]"
}
],
":=",
"expr"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
"(*",
" ",
RowBox[
{
"1.",
" ",
"There",
" ",
"is",
" ",
"Ricci",
" ",
"or",
" ",
RowBox[
{
"RicciScalar",
":",
" ",
RowBox[{"convert", " ", "to", " ", "Riemann"}]
}
]
}
],
" ",
"*)"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"HoldPattern",
"[",
" ",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr_",
",",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[{RowBox[{"Ricci", "|", "RicciScalar"}], ",", "m__"}],
"}"
}
],
",",
"c___"
}
],
"]"
}
],
",",
"metric_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"arrange",
"[",
RowBox[
{
RowBox[
{
"ScreenDollarIndices",
"[",
RowBox[
{
"RicciToRiemann",
"[",
RowBox[
{"expr", ",", RowBox[{"CovDOfMetric", "[", "metric", "]"}]}
],
"]"
}
],
"]"
}
],
",",
RowBox[
{
"casePlus",
"[",
RowBox[
{
RowBox[{"{", RowBox[{"Riemann", ",", "m"}], "}"}],
",",
"c"
}
],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[
{
"arrange",
"[",
RowBox[
{
RowBox[
{
RowBox[{"metric", "[", RowBox[{"a_", ",", "b_"}], "]"}],
"expr_"
}
],
",",
RowBox[
{
"casePlus",
"[",
RowBox[
{
"Infinity",
",",
RowBox[{"{", RowBox[{"Riemann", ",", "m__"}], "}"}],
",",
"c___"
}
],
"]"
}
],
",",
"metric_Symbol"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"metric", "[", RowBox[{"a", ",", "b"}], "]"}],
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr",
",",
RowBox[
{
"degrees",
"[",
RowBox[{"expr", ",", "CD", ",", "metric"}],
"]"
}
],
",",
"metric"
}
],
"]"
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"(*",
" ",
RowBox[
{
"2",
RowBox[{"a", ".", " ", "There"}],
" ",
"are",
" ",
"only",
" ",
RowBox[
{
"Riemanns",
":",
" ",
RowBox[
{
RowBox[{"compute", " ", "non"}],
"-",
RowBox[{"dual", " ", "permutation"}]
}
]
}
]
}
],
" ",
"*)"
}
],
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"(*",
RowBox[
{
"Change",
" ",
RowBox[
{
"here",
":",
" ",
RowBox[
{
"Get",
" ",
"indicesof",
" ",
"the",
" ",
"expression",
" ",
"and",
" ",
"the",
" ",
"rank",
" ",
"of",
" ",
"the",
" ",
"tensor"
}
]
}
]
}
],
"*)"
}
],
"\n",
RowBox[
{
RowBox[
{
RowBox[
{
"HoldPattern",
"[",
RowBox[
{
"arrange",
"[",
RowBox[
{
"expr_",
",",
RowBox[
{
"casePlus",
"[",
RowBox[{"{", RowBox[{"Riemann", ",", "Rcase__"}], "}"}],
"]"
}
],
",",
"metric_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
"With",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
"canonical",
"=",
RowBox[
{
RowBox[
{
RowBox[
{
"{",
RowBox[
{
RowBox[{"#", "[", RowBox[{"[", "1", "]"}], "]"}],
",",
RowBox[
{
"#",
"[",
RowBox[{"[", RowBox[{"2", ",", "1", ",", "1"}], "]"}],
"]"
}
],
",",
RowBox[
{
"frees",
"=",
RowBox[
{
"{",
RowBox[
{
"Length",
"[",
RowBox[
{RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}
],
"]"
}
],
"}"
}
]
}
]
}
],
"}"
}
],
"&"
}
],
"@",
RowBox[
{
"Reap",
"[",
RowBox[
{
RowBox[{"ToCanonical", "[", "expr", "]"}],
",",
"\"NewIndices\""
}
],
"]"
}
]
}
]
}
],
"}"
}
],
",",
RowBox[
{
"arrange1",
"[",
RowBox[
{
"canonical",
",",
RowBox[
{
"{",
RowBox[
{
RowBox[{"Sort", "[", RowBox[{"{", "Rcase", "}"}], "]"}],
",",
"0"
}
],
"}"
}
],
",",
"metric"
}
],
"]"
}
]
}
],
"]"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
"(*",
" ",
RowBox[{"4.", " ", "Final", " ", "arrangements"}],
" ",
"*)"
}
],
"\[IndentingNewLine]",
"\[IndentingNewLine]",
RowBox[
{
"(*",
RowBox[
{
"Change",
" ",
RowBox[
{
"here",
":",
" ",
RowBox[
{
"Now",
" ",
"arrange",
" ",
"will",
" ",
"have",
" ",
"the",
" ",
"indices",
" ",
"of",
" ",
"the",
" ",
RowBox[{"expression", ".", " ", "This"}],
" ",
"will",
" ",
"be"
}
]
}
]
}
],
"*)"
}
]
}
]
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
" ",
RowBox[
{
"the",
" ",
"list",
" ",
"used",
" ",
"to",
" ",
"get",
" ",
"the",
" ",
"correct",
" ",
"permutation"
}
],
" ",
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{"arrange1", "[", RowBox[{"0", ",", "_", ",", "_"}], "]"}
],
":=",
"0"
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"arrange1",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
"expr_",
",",
RowBox[
{"{", RowBox[{"sign_", ",", "perm_IndexList"}], "}"}
],
",",
"frees_"
}
],
"}"
}
],
",",
RowBox[
{"degs", ":", RowBox[{"{", RowBox[{"_", ",", "_"}], "}"}]}
],
",",
"metric_"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[{"RPerm", "[", "metric", "]"}],
"[",
RowBox[
{
"degs",
",",
"frees",
",",
RowBox[
{RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}
],
",",
RowBox[
{
"sign",
" ",
RowBox[
{
"TranslatePerm",
"[",
RowBox[
{
RowBox[
{
"PermutationFromTo",
"[",
RowBox[
{
RowBox[{"List", "@@", "perm"}],
",",
RowBox[
{"List", "@@", RowBox[{"IndexSort", "[", "perm", "]"}]}
]
}
],
"]"
}
],
",",
"Cycles"
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
]
}
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{"FromWeyl", "[", RowBox[{"expr_", ",", "cd_"}], "]"}
],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
RowBox[
{
RowBox[
{
RowBox[{"Weyl", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"Riemann", "[", "cd", "]"}]
}
],
",",
RowBox[
{
RowBox[{"TFRicci", "[", "cd", "]"}],
"\[RuleDelayed]",
RowBox[{"Ricci", "[", "cd", "]"}]
}
]
}
],
"}"
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Need",
" ",
"to",
" ",
"adjust",
" ",
"this",
" ",
"see",
" ",
"Riemann",
" ",
"simplify",
" ",
"for",
" ",
"more",
" ",
"details"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{"RicciToRiemann", "[", RowBox[{"expr_", ",", "cd_"}], "]"}
],
":=",
RowBox[
{
"With",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
RowBox[
{
"ricciscalar",
"=",
RowBox[{"RicciScalar", "[", "cd", "]"}]
}
],
",",
RowBox[{"ricci", "=", RowBox[{"Ricci", "[", "cd", "]"}]}],
",",
RowBox[
{"riemann", "=", RowBox[{"Riemann", "[", "cd", "]"}]}
],
",",
RowBox[
{
"vbundle",
"=",
RowBox[
{"First", "@", RowBox[{"VBundlesOfCovD", "[", "cd", "]"}]}
]
}
]
}
],
"}"
}
],
",",
RowBox[
{
"expr",
"/.",
RowBox[
{
"{",
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
RowBox[{"ricciscalar", "[", "]"}],
"\[RuleDelayed]",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[
{
RowBox[{"c", "=", RowBox[{"DummyIn", "@", "vbundle"}]}],
",",
RowBox[{"d", "=", RowBox[{"DummyIn", "@", "vbundle"}]}]
}
],
"}"
}
],
",",
RowBox[
{
"$RicciSign",
" ",
RowBox[
{
"riemann",
"[",
RowBox[
{
"c",
",",
"d",
",",
RowBox[{"-", "c"}],
",",
RowBox[{"-", "d"}]
}
],
"]"
}
]
}
]
}
],
"]"
}
]
}
],
",",
RowBox[
{
RowBox[{"ricci", "[", RowBox[{"a_", ",", "b_"}], "]"}],
"\[RuleDelayed]",
RowBox[
{
"Module",
"[",
RowBox[
{
RowBox[
{
"{",
RowBox[{"c", "=", RowBox[{"DummyIn", "@", "vbundle"}]}],
"}"
}
],
",",
RowBox[
{
"$RicciSign",
" ",
RowBox[
{
"riemann",
"[",
RowBox[{"a", ",", "c", ",", "b", ",", RowBox[{"-", "c"}]}],
"]"
}
]
}
]
}
],
"]"
}
]
}
]
}
],
"\[IndentingNewLine]",
"}"
}
]
}
]
}
],
"\[IndentingNewLine]",
"]"
}
]
}
],
";"
}
]
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["PermToInv", "Subsection"],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
"Invariants",
" ",
"will",
" ",
"now",
" ",
"have",
" ",
"the",
" ",
"indexlist",
" ",
"of",
" ",
"the",
" ",
"expression",
" ",
"this",
" ",
"is",
" ",
"stored",
" ",
"in",
" ",
RowBox[
{"RInv", "[", RowBox[{"metric", ",", "indexlist"}], "]"}
],
" ",
"and",
" ",
"is",
" ",
"used",
" ",
"so",
" ",
"we",
" ",
"can",
" ",
"convert",
" ",
"from",
" ",
"invariant",
" ",
"to",
" ",
"perm",
" ",
"as",
" ",
"the",
" ",
"permutation",
" ",
"now",
" ",
"depends",
" ",
"on",
" ",
"the",
" ",
"sorted",
" ",
"indexlist",
" ",
"instead",
" ",
"of",
" ",
"a",
" ",
"fixed",
" ",
"list",
" ",
"in",
" ",
"Invar"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToInv",
"[",
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_List", ",", "0"}], "}"}],
",",
RowBox[{"{", "Rank_", "}"}],
",",
"indexlist_",
",",
"perm_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"(",
RowBox[
{
"perm",
"/.",
RowBox[
{
"DispatchPermToRInvRules",
"[",
RowBox[{"Rank", ",", "case"}],
"]"
}
]
}
],
")"
}
],
"/.",
RowBox[
{
"RInv",
"->",
RowBox[
{"RInv", "[", RowBox[{"metric", ",", "indexlist"}], "]"}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToInv",
"[",
RowBox[
{
RowBox[{"RPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_List", ",", "1"}], "}"}],
",",
RowBox[{"{", "Rank_", "}"}],
",",
"indexlist_",
",",
"perm_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"(",
RowBox[
{
"perm",
"/.",
RowBox[
{
"DispatchPermToDualRInvRules",
"[",
RowBox[{"Rank", ",", "case"}],
"]"
}
]
}
],
")"
}
],
"/.",
RowBox[
{
"RInv",
"->",
RowBox[
{"RInv", "[", RowBox[{"metric", ",", "indexlist"}], "]"}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToInv",
"[",
RowBox[
{
RowBox[{"WPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_List", ",", "0"}], "}"}],
",",
RowBox[{"{", "Rank_", "}"}],
",",
"indexlist_",
",",
"perm_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"perm",
"/.",
RowBox[
{
"DispatchPermToRInvRules",
"[",
RowBox[{"Rank", ",", "case"}],
"]"
}
]
}
],
"/.",
RowBox[
{
"RInv",
"\[Rule]",
RowBox[
{"WInv", "[", RowBox[{"metric", ",", "indexlist"}], "]"}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"PermToInv",
"[",
RowBox[
{
RowBox[{"WPerm", "[", "metric_", "]"}],
"[",
RowBox[
{
RowBox[{"{", RowBox[{"case_List", ",", "1"}], "}"}],
",",
RowBox[{"{", "Rank_", "}"}],
",",
"indexlist_",
",",
"perm_"
}
],
"]"
}
],
"]"
}
],
":=",
RowBox[
{
RowBox[
{
"perm",
"/.",
RowBox[
{
"DispatchPermToDualRInvRules",
"[",
RowBox[{"Rank", ",", "case"}],
"]"
}
]
}
],
"/.",
RowBox[
{
"RInv",
"\[Rule]",
RowBox[
{
"DualRInv",
"[",
RowBox[{"metric", ",", "indexlist"}],
"]"
}
]
}
]
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[{"PermToInv", "[", "expr_", "]"}],
":=",
RowBox[
{
"expr",
"/.",
RowBox[
{
RowBox[
{
"perm",
":",
RowBox[
{
RowBox[
{
RowBox[{"(", RowBox[{"RPerm", "|", "WPerm"}], ")"}],
"[",
"_",
"]"
}
],
"[",
"__",
"]"
}
]
}
],
"\[RuleDelayed]",
RowBox[{"PermToInv", "[", "perm", "]"}]
}
]
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[{"PermToInv", ",", "1"}],
"]"
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["RiemannToInv", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"RiemannToInv", "[", "expr_", "]"}],
":=",
RowBox[
{
"RiemannToInv",
"[",
RowBox[{"expr", ",", "$Metrics"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToInv",
"[",
RowBox[{"expr_", ",", "metrics_List"}],
"]"
}
],
":=",
RowBox[
{
"Fold",
"[",
RowBox[{"RiemannToInv", ",", "expr", ",", "metrics"}],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannToInv",
"[",
RowBox[
{"expr_", ",", RowBox[{"metric_Symbol", "?", "MetricQ"}]}
],
"]"
}
],
":=",
RowBox[
{
"PermToInv",
"[",
RowBox[
{
"RiemannToPerm",
"[",
RowBox[{"expr", ",", "metric"}],
"]"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
{
RowBox[
{
RowBox[
{
RowBox[
{"RiemannToInv", "[", RowBox[{"expr_", ",", "x_"}], "]"}
],
":=",
RowBox[
{
"(",
RowBox[
{
RowBox[
{
"Message",
"[",
RowBox[
{
RowBox[{"RiemannToInv", "::", "unknown"}],
",",
"\"metric or list of metrics\"",
",",
"x"
}
],
"]"
}
],
";",
"expr"
}
],
")"
}
]
}
],
";"
}
],
"\[IndentingNewLine]",
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[
{
"RiemannToInv",
",",
RowBox[{"{", RowBox[{"1", ",", "2"}], "}"}]
}
],
"]"
}
],
";"
}
]
}
],
"Code"
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["RiemannSimplify", "Subsection"],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[{"RiemannSimplify", "[", "expr_", "]"}],
":=",
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr",
",",
"$InvSimplifyLevel",
",",
"$CurvatureRelations",
",",
"$Metrics"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
"(*",
RowBox[
{
RowBox[
{
RowBox[{"RiemannSimplify", "[", "expr_Plus", "]"}],
":=",
RowBox[
{
RowBox[{RowBox[{"RiemannSimplify", "[", "#", "]"}], "&"}],
"/@",
"expr"
}
]
}
],
";"
}
],
"*)"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannSimplify",
"[",
RowBox[{"expr_", ",", "step_Integer"}],
"]"
}
],
":=",
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr",
",",
"step",
",",
"$CurvatureRelations",
",",
"$Metrics"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr_",
",",
RowBox[
{
"cr",
":",
RowBox[{"(", RowBox[{"True", "|", "False"}], ")"}]
}
]
}
],
"]"
}
],
":=",
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr",
",",
"$InvSimplifyLevel",
",",
"cr",
",",
"$Metrics"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr_",
",",
RowBox[
{
"metric",
":",
RowBox[
{
"(",
RowBox[
{
RowBox[{"_Symbol", "?", "MetricQ"}],
"|",
RowBox[{"{", RowBox[{"__Symbol", "?", "MetricQ"}], "}"}]
}
],
")"
}
]
}
]
}
],
"]"
}
],
":=",
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr",
",",
"$InvSimplifyLevel",
",",
"$CurvatureRelations",
",",
"metric"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
RowBox[
{
"RiemannSimplify",
"[",
RowBox[
{
"expr_",
",",
"step_Integer",
",",
RowBox[
{
"cr",
":",
RowBox[{"(", RowBox[{"True", "|", "False"}], ")"}]
}
],
",",
"metric_"
}
],
"]"
}
],
":=",
RowBox[
{
"InvToRiemann",
"[",
RowBox[
{
RowBox[
{
"InvSimplify",
"[",
RowBox[
{
RowBox[
{"RiemannToInv", "[", RowBox[{"expr", ",", "metric"}], "]"}
],
",",
"step"
}
],
"]"
}
],
",",
"cr"
}
],
"]"
}
]
}
],
";"
}
]
],
"Code"
],
Cell[
BoxData[
RowBox[
{
RowBox[
{
"SetNumberOfArguments",
"[",
RowBox[
{
"RiemannSimplify",
",",
RowBox[{"{", RowBox[{"1", ",", "3"}], "}"}]
}
],
"]"
}
],
";"
}
]
],
"Code"
]
},
Closed
]
]
},
Closed
]
],
Cell[
CellGroupData[
{
Cell["End Package", "Section"],
Cell[
BoxData[
{
RowBox[{RowBox[{"End", "[", "]"}], ";"}],
"\n",
RowBox[
{RowBox[{"Protect", "[", "\"xAct`TInvar`*\"", "]"}], ";"}
],
"\n",
RowBox[
{
RowBox[
{
"Unprotect",
"[",
RowBox[
{
"xAct`TInvar`metric",
",",
"xAct`TInvar`dim",
",",
"xAct`TInvar`sigma",
",",
"xAct`TInvar`$InvSimplifyLevel",
",",
"xAct`TInvar`$CurvatureRelations",
",",
"$ExpandedCommuteOrder12Q",
",",
"xAct`TInvar`TInvarDirectory"
}
],
"]"
}
],
";"
}
],
"\n",
RowBox[{RowBox[{"EndPackage", "[", "]"}], ";"}]
}
],
"Code"
]
},
Closed
]
]
},
Open
]
]
},
AutoGeneratedPackage -> Automatic,
DockedCells -> { },
FrontEndVersion -> "13.3 for Mac OS X x86 (64-bit) (June 3, 2023)",
StyleDefinitions -> "Default.nb",
ExpressionUUID -> "5077c983-c36a-4700-a2b9-6d866aa32bce"
]